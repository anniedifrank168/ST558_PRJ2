[
  {
    "objectID": "data_analysis.html",
    "href": "data_analysis.html",
    "title": "NFL_Data_Analysis",
    "section": "",
    "text": "In this document we will do some exploratory data analysis of our data before creating an app.\nI found descriptions for the variable names here.\n\nNFL_data&lt;- read_csv(\"NFL_Play_by_Play_2009-2017(v4).csv\") \n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 407688 Columns: 102\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (34): SideofField, posteam, DefensiveTeam, desc, ExPointResult, TwoPoin...\ndbl  (64): GameID, Drive, qtr, down, TimeUnder, TimeSecs, PlayTimeDiff, yrdl...\nlgl   (2): DefTwoPoint, BlockingPlayer\ndate  (1): Date\ntime  (1): time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhead(NFL_data)\n\n# A tibble: 6 × 102\n  Date           GameID Drive   qtr  down time   TimeUnder TimeSecs PlayTimeDiff\n  &lt;date&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;time&gt;     &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;\n1 2009-09-10 2009091000     1     1    NA 15:00         15     3600            0\n2 2009-09-10 2009091000     1     1     1 14:53         15     3593            7\n3 2009-09-10 2009091000     1     1     2 14:16         15     3556           37\n4 2009-09-10 2009091000     1     1     3 13:35         14     3515           41\n5 2009-09-10 2009091000     1     1     4 13:27         14     3507            8\n6 2009-09-10 2009091000     2     1     1 13:16         14     3496           11\n# ℹ 93 more variables: SideofField &lt;chr&gt;, yrdln &lt;dbl&gt;, yrdline100 &lt;dbl&gt;,\n#   ydstogo &lt;dbl&gt;, ydsnet &lt;dbl&gt;, GoalToGo &lt;dbl&gt;, FirstDown &lt;dbl&gt;,\n#   posteam &lt;chr&gt;, DefensiveTeam &lt;chr&gt;, desc &lt;chr&gt;, PlayAttempted &lt;dbl&gt;,\n#   Yards.Gained &lt;dbl&gt;, sp &lt;dbl&gt;, Touchdown &lt;dbl&gt;, ExPointResult &lt;chr&gt;,\n#   TwoPointConv &lt;chr&gt;, DefTwoPoint &lt;lgl&gt;, Safety &lt;dbl&gt;, Onsidekick &lt;dbl&gt;,\n#   PuntResult &lt;chr&gt;, PlayType &lt;chr&gt;, Passer &lt;chr&gt;, Passer_ID &lt;chr&gt;,\n#   PassAttempt &lt;dbl&gt;, PassOutcome &lt;chr&gt;, PassLength &lt;chr&gt;, AirYards &lt;dbl&gt;, …\n\n#Imported as a tibble. Has 102 different variables \nhead(str(NFL_data))\n\nspc_tbl_ [407,688 × 102] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Date                       : Date[1:407688], format: \"2009-09-10\" \"2009-09-10\" ...\n $ GameID                     : num [1:407688] 2.01e+09 2.01e+09 2.01e+09 2.01e+09 2.01e+09 ...\n $ Drive                      : num [1:407688] 1 1 1 1 1 2 2 2 2 3 ...\n $ qtr                        : num [1:407688] 1 1 1 1 1 1 1 1 1 1 ...\n $ down                       : num [1:407688] NA 1 2 3 4 1 2 3 4 1 ...\n $ time                       : 'hms' num [1:407688] 15:00:00 14:53:00 14:16:00 13:35:00 ...\n  ..- attr(*, \"units\")= chr \"secs\"\n $ TimeUnder                  : num [1:407688] 15 15 15 14 14 14 13 13 12 12 ...\n $ TimeSecs                   : num [1:407688] 3600 3593 3556 3515 3507 ...\n $ PlayTimeDiff               : num [1:407688] 0 7 37 41 8 11 36 29 37 10 ...\n $ SideofField                : chr [1:407688] \"TEN\" \"PIT\" \"PIT\" \"PIT\" ...\n $ yrdln                      : num [1:407688] 30 42 47 44 44 2 2 6 4 43 ...\n $ yrdline100                 : num [1:407688] 30 58 53 56 56 98 98 94 96 43 ...\n $ ydstogo                    : num [1:407688] 0 10 5 8 8 10 10 6 8 10 ...\n $ ydsnet                     : num [1:407688] 0 5 2 2 2 0 4 2 2 3 ...\n $ GoalToGo                   : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ FirstDown                  : num [1:407688] NA 0 0 0 1 0 0 0 1 0 ...\n $ posteam                    : chr [1:407688] \"PIT\" \"PIT\" \"PIT\" \"PIT\" ...\n $ DefensiveTeam              : chr [1:407688] \"TEN\" \"TEN\" \"TEN\" \"TEN\" ...\n $ desc                       : chr [1:407688] \"R.Bironas kicks 67 yards from TEN 30 to PIT 3. S.Logan to PIT 42 for 39 yards (M.Griffin).\" \"(14:53) B.Roethlisberger pass short left to H.Ward to PIT 47 for 5 yards (C.Hope).\" \"(14:16) W.Parker right end to PIT 44 for -3 yards (S.Tulloch).\" \"(13:35) (Shotgun) B.Roethlisberger pass incomplete deep right to M.Wallace. COVERAGE BY #24 HOPE\" ...\n $ PlayAttempted              : num [1:407688] 1 1 1 1 1 1 1 1 1 1 ...\n $ Yards.Gained               : num [1:407688] 39 5 -3 0 0 0 4 -2 11 3 ...\n $ sp                         : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ Touchdown                  : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ ExPointResult              : chr [1:407688] NA NA NA NA ...\n $ TwoPointConv               : chr [1:407688] NA NA NA NA ...\n $ DefTwoPoint                : logi [1:407688] NA NA NA NA NA NA ...\n $ Safety                     : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ Onsidekick                 : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ PuntResult                 : chr [1:407688] NA NA NA NA ...\n $ PlayType                   : chr [1:407688] \"Kickoff\" \"Pass\" \"Run\" \"Pass\" ...\n $ Passer                     : chr [1:407688] NA \"B.Roethlisberger\" NA \"B.Roethlisberger\" ...\n $ Passer_ID                  : chr [1:407688] \"None\" \"00-0022924\" \"None\" \"00-0022924\" ...\n $ PassAttempt                : num [1:407688] 0 1 0 1 0 0 1 0 0 1 ...\n $ PassOutcome                : chr [1:407688] NA \"Complete\" NA \"Incomplete Pass\" ...\n $ PassLength                 : chr [1:407688] NA \"Short\" NA \"Deep\" ...\n $ AirYards                   : num [1:407688] 0 -3 0 34 0 0 3 0 0 -2 ...\n $ YardsAfterCatch            : num [1:407688] 0 8 0 0 0 0 1 0 0 5 ...\n $ QBHit                      : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ PassLocation               : chr [1:407688] NA \"left\" NA \"right\" ...\n $ InterceptionThrown         : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ Interceptor                : chr [1:407688] NA NA NA NA ...\n $ Rusher                     : chr [1:407688] NA NA \"W.Parker\" NA ...\n $ Rusher_ID                  : chr [1:407688] \"None\" \"None\" \"00-0022250\" \"None\" ...\n $ RushAttempt                : num [1:407688] 0 0 1 0 0 1 0 1 0 0 ...\n $ RunLocation                : chr [1:407688] NA NA \"right\" NA ...\n $ RunGap                     : chr [1:407688] NA NA \"end\" NA ...\n $ Receiver                   : chr [1:407688] NA \"H.Ward\" NA \"M.Wallace\" ...\n $ Receiver_ID                : chr [1:407688] \"None\" \"00-0017162\" \"None\" \"00-0026901\" ...\n $ Reception                  : num [1:407688] 0 1 0 0 0 0 1 0 0 1 ...\n $ ReturnResult               : chr [1:407688] NA NA NA NA ...\n $ Returner                   : chr [1:407688] \"S.Logan\" NA NA NA ...\n $ BlockingPlayer             : logi [1:407688] NA NA NA NA NA NA ...\n $ Tackler1                   : chr [1:407688] \"M.Griffin\" \"C.Hope\" \"S.Tulloch\" NA ...\n $ Tackler2                   : chr [1:407688] NA NA NA NA ...\n $ FieldGoalResult            : chr [1:407688] NA NA NA NA ...\n $ FieldGoalDistance          : num [1:407688] NA NA NA NA NA NA NA NA NA NA ...\n $ Fumble                     : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ RecFumbTeam                : chr [1:407688] NA NA NA NA ...\n $ RecFumbPlayer              : chr [1:407688] NA NA NA NA ...\n $ Sack                       : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ Challenge.Replay           : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ ChalReplayResult           : chr [1:407688] NA NA NA NA ...\n $ Accepted.Penalty           : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ PenalizedTeam              : chr [1:407688] NA NA NA NA ...\n $ PenaltyType                : chr [1:407688] NA NA NA NA ...\n $ PenalizedPlayer            : chr [1:407688] NA NA NA NA ...\n $ Penalty.Yards              : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ PosTeamScore               : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ DefTeamScore               : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ ScoreDiff                  : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ AbsScoreDiff               : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ HomeTeam                   : chr [1:407688] \"PIT\" \"PIT\" \"PIT\" \"PIT\" ...\n $ AwayTeam                   : chr [1:407688] \"TEN\" \"TEN\" \"TEN\" \"TEN\" ...\n $ Timeout_Indicator          : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ Timeout_Team               : chr [1:407688] \"None\" \"None\" \"None\" \"None\" ...\n $ posteam_timeouts_pre       : num [1:407688] 3 3 3 3 3 3 3 3 3 3 ...\n $ HomeTimeouts_Remaining_Pre : num [1:407688] 3 3 3 3 3 3 3 3 3 3 ...\n $ AwayTimeouts_Remaining_Pre : num [1:407688] 3 3 3 3 3 3 3 3 3 3 ...\n $ HomeTimeouts_Remaining_Post: num [1:407688] 3 3 3 3 3 3 3 3 3 3 ...\n $ AwayTimeouts_Remaining_Post: num [1:407688] 3 3 3 3 3 3 3 3 3 3 ...\n $ No_Score_Prob              : num [1:407688] 0.001506 0.000969 0.001057 0.001434 0.001861 ...\n $ Opp_Field_Goal_Prob        : num [1:407688] 0.18 0.109 0.105 0.149 0.213 ...\n $ Opp_Safety_Prob            : num [1:407688] 0.006639 0.001061 0.000981 0.001944 0.003279 ...\n $ Opp_Touchdown_Prob         : num [1:407688] 0.281 0.169 0.163 0.235 0.322 ...\n $ Field_Goal_Prob            : num [1:407688] 0.214 0.294 0.305 0.289 0.245 ...\n $ Safety_Prob                : num [1:407688] 0.00359 0.00364 0.00383 0.00478 0.0064 ...\n $ Touchdown_Prob             : num [1:407688] 0.314 0.423 0.421 0.319 0.208 ...\n $ ExPoint_Prob               : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ TwoPoint_Prob              : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ ExpPts                     : num [1:407688] 0.324 2.338 2.416 1.013 -0.699 ...\n $ EPA                        : num [1:407688] 2.0145 0.0779 -1.4028 -1.7126 2.0978 ...\n $ airEPA                     : num [1:407688] NA -1.07 NA 3.32 NA ...\n $ yacEPA                     : num [1:407688] NA 1.15 NA -5.03 NA ...\n $ Home_WP_pre                : num [1:407688] 0.486 0.546 0.551 0.511 0.461 ...\n $ Away_WP_pre                : num [1:407688] 0.514 0.454 0.449 0.489 0.539 ...\n $ Home_WP_post               : num [1:407688] 0.546 0.551 0.511 0.461 0.559 ...\n $ Away_WP_post               : num [1:407688] 0.454 0.449 0.489 0.539 0.441 ...\n $ Win_Prob                   : num [1:407688] 0.486 0.546 0.551 0.511 0.461 ...\n $ WPA                        : num [1:407688] 0.06076 0.00465 -0.04029 -0.04958 0.09771 ...\n  [list output truncated]\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Date = col_date(format = \"\"),\n  ..   GameID = col_double(),\n  ..   Drive = col_double(),\n  ..   qtr = col_double(),\n  ..   down = col_double(),\n  ..   time = col_time(format = \"\"),\n  ..   TimeUnder = col_double(),\n  ..   TimeSecs = col_double(),\n  ..   PlayTimeDiff = col_double(),\n  ..   SideofField = col_character(),\n  ..   yrdln = col_double(),\n  ..   yrdline100 = col_double(),\n  ..   ydstogo = col_double(),\n  ..   ydsnet = col_double(),\n  ..   GoalToGo = col_double(),\n  ..   FirstDown = col_double(),\n  ..   posteam = col_character(),\n  ..   DefensiveTeam = col_character(),\n  ..   desc = col_character(),\n  ..   PlayAttempted = col_double(),\n  ..   Yards.Gained = col_double(),\n  ..   sp = col_double(),\n  ..   Touchdown = col_double(),\n  ..   ExPointResult = col_character(),\n  ..   TwoPointConv = col_character(),\n  ..   DefTwoPoint = col_logical(),\n  ..   Safety = col_double(),\n  ..   Onsidekick = col_double(),\n  ..   PuntResult = col_character(),\n  ..   PlayType = col_character(),\n  ..   Passer = col_character(),\n  ..   Passer_ID = col_character(),\n  ..   PassAttempt = col_double(),\n  ..   PassOutcome = col_character(),\n  ..   PassLength = col_character(),\n  ..   AirYards = col_double(),\n  ..   YardsAfterCatch = col_double(),\n  ..   QBHit = col_double(),\n  ..   PassLocation = col_character(),\n  ..   InterceptionThrown = col_double(),\n  ..   Interceptor = col_character(),\n  ..   Rusher = col_character(),\n  ..   Rusher_ID = col_character(),\n  ..   RushAttempt = col_double(),\n  ..   RunLocation = col_character(),\n  ..   RunGap = col_character(),\n  ..   Receiver = col_character(),\n  ..   Receiver_ID = col_character(),\n  ..   Reception = col_double(),\n  ..   ReturnResult = col_character(),\n  ..   Returner = col_character(),\n  ..   BlockingPlayer = col_logical(),\n  ..   Tackler1 = col_character(),\n  ..   Tackler2 = col_character(),\n  ..   FieldGoalResult = col_character(),\n  ..   FieldGoalDistance = col_double(),\n  ..   Fumble = col_double(),\n  ..   RecFumbTeam = col_character(),\n  ..   RecFumbPlayer = col_character(),\n  ..   Sack = col_double(),\n  ..   Challenge.Replay = col_double(),\n  ..   ChalReplayResult = col_character(),\n  ..   Accepted.Penalty = col_double(),\n  ..   PenalizedTeam = col_character(),\n  ..   PenaltyType = col_character(),\n  ..   PenalizedPlayer = col_character(),\n  ..   Penalty.Yards = col_double(),\n  ..   PosTeamScore = col_double(),\n  ..   DefTeamScore = col_double(),\n  ..   ScoreDiff = col_double(),\n  ..   AbsScoreDiff = col_double(),\n  ..   HomeTeam = col_character(),\n  ..   AwayTeam = col_character(),\n  ..   Timeout_Indicator = col_double(),\n  ..   Timeout_Team = col_character(),\n  ..   posteam_timeouts_pre = col_double(),\n  ..   HomeTimeouts_Remaining_Pre = col_double(),\n  ..   AwayTimeouts_Remaining_Pre = col_double(),\n  ..   HomeTimeouts_Remaining_Post = col_double(),\n  ..   AwayTimeouts_Remaining_Post = col_double(),\n  ..   No_Score_Prob = col_double(),\n  ..   Opp_Field_Goal_Prob = col_double(),\n  ..   Opp_Safety_Prob = col_double(),\n  ..   Opp_Touchdown_Prob = col_double(),\n  ..   Field_Goal_Prob = col_double(),\n  ..   Safety_Prob = col_double(),\n  ..   Touchdown_Prob = col_double(),\n  ..   ExPoint_Prob = col_double(),\n  ..   TwoPoint_Prob = col_double(),\n  ..   ExpPts = col_double(),\n  ..   EPA = col_double(),\n  ..   airEPA = col_double(),\n  ..   yacEPA = col_double(),\n  ..   Home_WP_pre = col_double(),\n  ..   Away_WP_pre = col_double(),\n  ..   Home_WP_post = col_double(),\n  ..   Away_WP_post = col_double(),\n  ..   Win_Prob = col_double(),\n  ..   WPA = col_double(),\n  ..   airWPA = col_double(),\n  ..   yacWPA = col_double(),\n  ..   Season = col_double()\n  .. )\n - attr(*, \"problems\")=&lt;externalptr&gt; \n\n\nNULL\n\n#psych::describe(NFL_data)\n#I am going to filter to just a 5 year span, 2012-2017, just because the dataset is so huge and taking a long time to load for a lot of things. \nNFL_data &lt;- NFL_data%&gt;% filter(Season &gt;= 2013) \npsych::describe(NFL_data)\n\n                            vars      n          mean         sd       median\nDate                           1 227856           NaN         NA           NA\nGameID                         2 227856 2015130986.35 1425466.93 2.015111e+09\nDrive                          3 227856         12.25       7.12 1.200000e+01\nqtr                            4 227856          2.58       1.13 3.000000e+00\ndown                           5 193519          2.00       1.01 2.000000e+00\ntime                           6 227729           NaN         NA           NA\nTimeUnder                      7 227856          7.36       4.64 7.000000e+00\nTimeSecs                       8 227729       1694.47    1062.59 1.800000e+03\nPlayTimeDiff                   9 227606         20.43      17.81 1.700000e+01\nSideofField                   10 227559           NaN         NA           NA\nyrdln                         11 227384         28.58      12.79 3.000000e+01\nyrdline100                    12 227384         48.88      24.92 5.000000e+01\nydstogo                       13 227856          7.33       4.90 9.000000e+00\nydsnet                        14 227856         26.38      25.07 2.000000e+01\nGoalToGo                      15 227384          0.05       0.22 0.000000e+00\nFirstDown                     16 211649          0.29       0.45 0.000000e+00\nposteam                       17 213838           NaN         NA           NA\nDefensiveTeam                 18 213838           NaN         NA           NA\ndesc                          19 227856           NaN         NA           NA\nPlayAttempted                 20 227856          1.00       0.00 1.000000e+00\nYards.Gained                  21 227856          4.86       8.94 1.000000e+00\nsp                            22 227856          0.07       0.26 0.000000e+00\nTouchdown                     23 227856          0.03       0.17 0.000000e+00\nExPointResult                 24   5635           NaN         NA           NA\nTwoPointConv                  25    395           NaN         NA           NA\nDefTwoPoint                   26      0           NaN         NA           NA\nSafety                        27 227856          0.00       0.02 0.000000e+00\nOnsidekick                    28 227856          0.00       0.04 0.000000e+00\nPuntResult                    29  12344           NaN         NA           NA\nPlayType                      30 227856           NaN         NA           NA\nPasser                        31  95311           NaN         NA           NA\nPasser_ID                     32 227856           NaN         NA           NA\nPassAttempt                   33 227856          0.42       0.49 0.000000e+00\nPassOutcome                   34  95339           NaN         NA           NA\nPassLength                    35  94769           NaN         NA           NA\nAirYards                      36 227856          3.28       7.52 0.000000e+00\nYardsAfterCatch               37 227856          1.29       4.23 0.000000e+00\nQBHit                         38 227856          0.06       0.23 0.000000e+00\nPassLocation                  39  94769           NaN         NA           NA\nInterceptionThrown            40 227856          0.01       0.10 0.000000e+00\nInterceptor                   41   2391           NaN         NA           NA\nRusher                        42  66169           NaN         NA           NA\nRusher_ID                     43 227856           NaN         NA           NA\nRushAttempt                   44 227856          0.29       0.45 0.000000e+00\nRunLocation                   45  65580           NaN         NA           NA\nRunGap                        46  47850           NaN         NA           NA\nReceiver                      47  91637           NaN         NA           NA\nReceiver_ID                   48 227856           NaN         NA           NA\nReception                     49 227856          0.25       0.44 0.000000e+00\nReturnResult                  50  11623           NaN         NA           NA\nReturner                      51  12717           NaN         NA           NA\nBlockingPlayer                52      0           NaN         NA           NA\nTackler1                      53 133364           NaN         NA           NA\nTackler2                      54  26839           NaN         NA           NA\nFieldGoalResult               55   5093           NaN         NA           NA\nFieldGoalDistance             56   5024         37.87      10.25 3.800000e+01\nFumble                        57 227856          0.01       0.12 0.000000e+00\nRecFumbTeam                   58   2290           NaN         NA           NA\nRecFumbPlayer                 59   2290           NaN         NA           NA\nSack                          60 227856          0.03       0.16 0.000000e+00\nChallenge.Replay              61 227856          0.01       0.09 0.000000e+00\nChalReplayResult              62   2001           NaN         NA           NA\nAccepted.Penalty              63 227856          0.07       0.26 0.000000e+00\nPenalizedTeam                 64  16888           NaN         NA           NA\nPenaltyType                   65   9264           NaN         NA           NA\nPenalizedPlayer               66  16240           NaN         NA           NA\nPenalty.Yards                 67 227856          0.63       2.68 0.000000e+00\nPosTeamScore                  68 212772         10.26       9.39 8.000000e+00\nDefTeamScore                  69 212772         11.54       9.90 1.000000e+01\nScoreDiff                     70 213839         -1.25      10.57 0.000000e+00\nAbsScoreDiff                  71 212772          7.69       7.33 7.000000e+00\nHomeTeam                      72 227856           NaN         NA           NA\nAwayTeam                      73 227856           NaN         NA           NA\nTimeout_Indicator             74 227856          0.04       0.20 0.000000e+00\nTimeout_Team                  75 227856           NaN         NA           NA\nposteam_timeouts_pre          76 227856          2.53       0.78 3.000000e+00\nHomeTimeouts_Remaining_Pre    77 227856          2.55       0.75 3.000000e+00\nAwayTimeouts_Remaining_Pre    78 227856          2.53       0.78 3.000000e+00\nHomeTimeouts_Remaining_Post   79 227856          2.53       0.77 3.000000e+00\nAwayTimeouts_Remaining_Post   80 227856          2.50       0.80 3.000000e+00\nNo_Score_Prob                 81 227757          0.13       0.20 2.000000e-02\nOpp_Field_Goal_Prob           82 227757          0.09       0.07 8.000000e-02\nOpp_Safety_Prob               83 227757          0.00       0.00 0.000000e+00\nOpp_Touchdown_Prob            84 227757          0.14       0.11 1.200000e-01\nField_Goal_Prob               85 227757          0.24       0.16 2.300000e-01\nSafety_Prob                   86 227757          0.00       0.00 0.000000e+00\nTouchdown_Prob                87 227757          0.30       0.17 3.100000e-01\nExPoint_Prob                  88 227856          0.02       0.15 0.000000e+00\nTwoPoint_Prob                 89 227856          0.00       0.02 0.000000e+00\nExpPts                        90 227757          1.56       1.75 1.220000e+00\nEPA                           91 227658          0.03       1.32 0.000000e+00\nairEPA                        92  90023          0.52       1.39 2.900000e-01\nyacEPA                        93  89962         -0.37       1.96 0.000000e+00\nHome_WP_pre                   94 213841          0.54       0.28 5.400000e-01\nAway_WP_pre                   95 213841          0.46       0.28 4.600000e-01\nHome_WP_post                  96 212931          0.54       0.29 5.400000e-01\nAway_WP_post                  97 212931          0.46       0.29 4.600000e-01\nWin_Prob                      98 213811          0.50       0.29 5.000000e-01\nWPA                           99 224761          0.00       0.05 0.000000e+00\nairWPA                       100  89958          0.02       0.06 0.000000e+00\nyacWPA                       101  89806         -0.01       0.07 0.000000e+00\nSeason                       102 227856       2015.00       1.41 2.015000e+03\n                                     min          max      range  skew kurtosis\nDate                                 Inf         -Inf       -Inf    NA       NA\nGameID                       2.01309e+09 2.017123e+09 4032615.00 -0.02    -1.32\nDrive                        1.00000e+00 3.500000e+01      34.00  0.20    -0.92\nqtr                          1.00000e+00 5.000000e+00       4.00  0.00    -1.30\ndown                         1.00000e+00 4.000000e+00       3.00  0.61    -0.79\ntime                                 Inf         -Inf       -Inf    NA       NA\nTimeUnder                    0.00000e+00 1.500000e+01      15.00  0.15    -1.28\nTimeSecs                    -9.00000e+02 3.600000e+03    4500.00  0.03    -1.12\nPlayTimeDiff                 0.00000e+00 9.430000e+02     943.00  5.91   274.64\nSideofField                          Inf         -Inf       -Inf    NA       NA\nyrdln                        1.00000e+00 5.000000e+01      49.00 -0.29    -0.81\nyrdline100                   1.00000e+00 9.900000e+01      98.00 -0.13    -1.03\nydstogo                      0.00000e+00 4.800000e+01      48.00  0.35     0.98\nydsnet                      -8.40000e+01 9.900000e+01     183.00  0.70    -0.56\nGoalToGo                     0.00000e+00 1.000000e+00       1.00  4.15    15.25\nFirstDown                    0.00000e+00 1.000000e+00       1.00  0.92    -1.15\nposteam                              Inf         -Inf       -Inf    NA       NA\nDefensiveTeam                        Inf         -Inf       -Inf    NA       NA\ndesc                                 Inf         -Inf       -Inf    NA       NA\nPlayAttempted                1.00000e+00 1.000000e+00       0.00   NaN      NaN\nYards.Gained                -3.40000e+01 9.900000e+01     133.00  2.95    14.22\nsp                           0.00000e+00 1.000000e+00       1.00  3.31     8.97\nTouchdown                    0.00000e+00 1.000000e+00       1.00  5.59    29.27\nExPointResult                        Inf         -Inf       -Inf    NA       NA\nTwoPointConv                         Inf         -Inf       -Inf    NA       NA\nDefTwoPoint                          Inf         -Inf       -Inf    NA       NA\nSafety                       0.00000e+00 1.000000e+00       1.00 48.94  2393.46\nOnsidekick                   0.00000e+00 1.000000e+00       1.00 26.59   704.83\nPuntResult                           Inf         -Inf       -Inf    NA       NA\nPlayType                             Inf         -Inf       -Inf    NA       NA\nPasser                               Inf         -Inf       -Inf    NA       NA\nPasser_ID                            Inf         -Inf       -Inf    NA       NA\nPassAttempt                  0.00000e+00 1.000000e+00       1.00  0.33    -1.89\nPassOutcome                          Inf         -Inf       -Inf    NA       NA\nPassLength                           Inf         -Inf       -Inf    NA       NA\nAirYards                    -4.10000e+01 6.600000e+01     107.00  2.90    10.16\nYardsAfterCatch             -4.40000e+01 8.800000e+01     132.00  6.22    60.18\nQBHit                        0.00000e+00 1.000000e+00       1.00  3.87    12.98\nPassLocation                         Inf         -Inf       -Inf    NA       NA\nInterceptionThrown           0.00000e+00 1.000000e+00       1.00  9.60    90.11\nInterceptor                          Inf         -Inf       -Inf    NA       NA\nRusher                               Inf         -Inf       -Inf    NA       NA\nRusher_ID                            Inf         -Inf       -Inf    NA       NA\nRushAttempt                  0.00000e+00 1.000000e+00       1.00  0.92    -1.15\nRunLocation                          Inf         -Inf       -Inf    NA       NA\nRunGap                               Inf         -Inf       -Inf    NA       NA\nReceiver                             Inf         -Inf       -Inf    NA       NA\nReceiver_ID                          Inf         -Inf       -Inf    NA       NA\nReception                    0.00000e+00 1.000000e+00       1.00  1.13    -0.73\nReturnResult                         Inf         -Inf       -Inf    NA       NA\nReturner                             Inf         -Inf       -Inf    NA       NA\nBlockingPlayer                       Inf         -Inf       -Inf    NA       NA\nTackler1                             Inf         -Inf       -Inf    NA       NA\nTackler2                             Inf         -Inf       -Inf    NA       NA\nFieldGoalResult                      Inf         -Inf       -Inf    NA       NA\nFieldGoalDistance            1.80000e+01 7.100000e+01      53.00  0.00    -1.00\nFumble                       0.00000e+00 1.000000e+00       1.00  8.41    68.78\nRecFumbTeam                          Inf         -Inf       -Inf    NA       NA\nRecFumbPlayer                        Inf         -Inf       -Inf    NA       NA\nSack                         0.00000e+00 1.000000e+00       1.00  5.75    31.02\nChallenge.Replay             0.00000e+00 1.000000e+00       1.00 10.52   108.60\nChalReplayResult                     Inf         -Inf       -Inf    NA       NA\nAccepted.Penalty             0.00000e+00 1.000000e+00       1.00  3.25     8.57\nPenalizedTeam                        Inf         -Inf       -Inf    NA       NA\nPenaltyType                          Inf         -Inf       -Inf    NA       NA\nPenalizedPlayer                      Inf         -Inf       -Inf    NA       NA\nPenalty.Yards                0.00000e+00 6.600000e+01      66.00  6.04    52.71\nPosTeamScore                 0.00000e+00 5.600000e+01      56.00  0.89     0.44\nDefTeamScore                 0.00000e+00 5.600000e+01      56.00  0.82     0.27\nScoreDiff                   -5.40000e+01 5.300000e+01     107.00 -0.06     1.25\nAbsScoreDiff                 0.00000e+00 5.400000e+01      54.00  1.37     2.20\nHomeTeam                             Inf         -Inf       -Inf    NA       NA\nAwayTeam                             Inf         -Inf       -Inf    NA       NA\nTimeout_Indicator            0.00000e+00 1.000000e+00       1.00  4.63    19.40\nTimeout_Team                         Inf         -Inf       -Inf    NA       NA\nposteam_timeouts_pre         0.00000e+00 3.000000e+00       3.00 -1.69     2.19\nHomeTimeouts_Remaining_Pre  -1.00000e+00 3.000000e+00       4.00 -1.74     2.45\nAwayTimeouts_Remaining_Pre  -1.00000e+00 3.000000e+00       4.00 -1.68     2.19\nHomeTimeouts_Remaining_Post -1.00000e+00 3.000000e+00       4.00 -1.69     2.23\nAwayTimeouts_Remaining_Post -1.00000e+00 3.000000e+00       4.00 -1.63     1.98\nNo_Score_Prob                0.00000e+00 1.000000e+00       1.00  1.97     3.58\nOpp_Field_Goal_Prob          0.00000e+00 3.600000e-01       0.36  0.58    -0.38\nOpp_Safety_Prob              0.00000e+00 3.000000e-02       0.03  2.33     7.55\nOpp_Touchdown_Prob           0.00000e+00 5.000000e-01       0.50  0.52    -0.65\nField_Goal_Prob              0.00000e+00 9.900000e-01       0.99  1.29     4.21\nSafety_Prob                  0.00000e+00 2.000000e-02       0.02 -0.15     1.21\nTouchdown_Prob               0.00000e+00 9.100000e-01       0.91  0.08     0.27\nExPoint_Prob                 0.00000e+00 9.900000e-01       0.99  6.13    35.63\nTwoPoint_Prob                0.00000e+00 4.700000e-01       0.47 23.96   571.85\nExpPts                      -3.84000e+00 6.500000e+00      10.34  0.26    -0.31\nEPA                         -1.34900e+01 9.510000e+00      23.00 -0.26     6.89\nairEPA                      -1.28500e+01 7.350000e+00      20.20  0.55     0.42\nyacEPA                      -1.40000e+01 9.410000e+00      23.41 -1.02     2.62\nHome_WP_pre                  0.00000e+00 1.000000e+00       1.00 -0.14    -0.93\nAway_WP_pre                  0.00000e+00 1.000000e+00       1.00  0.14    -0.93\nHome_WP_post                 0.00000e+00 1.000000e+00       1.00 -0.14    -0.95\nAway_WP_post                 0.00000e+00 1.000000e+00       1.00  0.14    -0.95\nWin_Prob                     0.00000e+00 1.000000e+00       1.00 -0.02    -0.97\nWPA                         -9.80000e-01 9.900000e-01       1.98  0.50    70.60\nairWPA                      -9.90000e-01 9.900000e-01       1.99  1.79    64.53\nyacWPA                      -9.80000e-01 1.000000e+00       1.98 -1.78    34.21\nSeason                       2.01300e+03 2.017000e+03       4.00  0.00    -1.29\n                                 se\nDate                             NA\nGameID                      2986.26\nDrive                          0.01\nqtr                            0.00\ndown                           0.00\ntime                             NA\nTimeUnder                      0.01\nTimeSecs                       2.23\nPlayTimeDiff                   0.04\nSideofField                      NA\nyrdln                          0.03\nyrdline100                     0.05\nydstogo                        0.01\nydsnet                         0.05\nGoalToGo                       0.00\nFirstDown                      0.00\nposteam                          NA\nDefensiveTeam                    NA\ndesc                             NA\nPlayAttempted                  0.00\nYards.Gained                   0.02\nsp                             0.00\nTouchdown                      0.00\nExPointResult                    NA\nTwoPointConv                     NA\nDefTwoPoint                      NA\nSafety                         0.00\nOnsidekick                     0.00\nPuntResult                       NA\nPlayType                         NA\nPasser                           NA\nPasser_ID                        NA\nPassAttempt                    0.00\nPassOutcome                      NA\nPassLength                       NA\nAirYards                       0.02\nYardsAfterCatch                0.01\nQBHit                          0.00\nPassLocation                     NA\nInterceptionThrown             0.00\nInterceptor                      NA\nRusher                           NA\nRusher_ID                        NA\nRushAttempt                    0.00\nRunLocation                      NA\nRunGap                           NA\nReceiver                         NA\nReceiver_ID                      NA\nReception                      0.00\nReturnResult                     NA\nReturner                         NA\nBlockingPlayer                   NA\nTackler1                         NA\nTackler2                         NA\nFieldGoalResult                  NA\nFieldGoalDistance              0.14\nFumble                         0.00\nRecFumbTeam                      NA\nRecFumbPlayer                    NA\nSack                           0.00\nChallenge.Replay               0.00\nChalReplayResult                 NA\nAccepted.Penalty               0.00\nPenalizedTeam                    NA\nPenaltyType                      NA\nPenalizedPlayer                  NA\nPenalty.Yards                  0.01\nPosTeamScore                   0.02\nDefTeamScore                   0.02\nScoreDiff                      0.02\nAbsScoreDiff                   0.02\nHomeTeam                         NA\nAwayTeam                         NA\nTimeout_Indicator              0.00\nTimeout_Team                     NA\nposteam_timeouts_pre           0.00\nHomeTimeouts_Remaining_Pre     0.00\nAwayTimeouts_Remaining_Pre     0.00\nHomeTimeouts_Remaining_Post    0.00\nAwayTimeouts_Remaining_Post    0.00\nNo_Score_Prob                  0.00\nOpp_Field_Goal_Prob            0.00\nOpp_Safety_Prob                0.00\nOpp_Touchdown_Prob             0.00\nField_Goal_Prob                0.00\nSafety_Prob                    0.00\nTouchdown_Prob                 0.00\nExPoint_Prob                   0.00\nTwoPoint_Prob                  0.00\nExpPts                         0.00\nEPA                            0.00\nairEPA                         0.00\nyacEPA                         0.01\nHome_WP_pre                    0.00\nAway_WP_pre                    0.00\nHome_WP_post                   0.00\nAway_WP_post                   0.00\nWin_Prob                       0.00\nWPA                            0.00\nairWPA                         0.00\nyacWPA                         0.00\nSeason                         0.00\n\n#def2point is all NA in this version, but I am not interested in this variable anyway \nNFL_data &lt;- NFL_data %&gt;% select(-DefTwoPoint)\ncolSums(is.na(NFL_data))\n\n                       Date                      GameID \n                          0                           0 \n                      Drive                         qtr \n                          0                           0 \n                       down                        time \n                      34337                         127 \n                  TimeUnder                    TimeSecs \n                          0                         127 \n               PlayTimeDiff                 SideofField \n                        250                         297 \n                      yrdln                  yrdline100 \n                        472                         472 \n                    ydstogo                      ydsnet \n                          0                           0 \n                   GoalToGo                   FirstDown \n                        472                       16207 \n                    posteam               DefensiveTeam \n                      14018                       14018 \n                       desc               PlayAttempted \n                          0                           0 \n               Yards.Gained                          sp \n                          0                           0 \n                  Touchdown               ExPointResult \n                          0                      222221 \n               TwoPointConv                      Safety \n                     227461                           0 \n                 Onsidekick                  PuntResult \n                          0                      215512 \n                   PlayType                      Passer \n                          0                      132545 \n                  Passer_ID                 PassAttempt \n                          0                           0 \n                PassOutcome                  PassLength \n                     132517                      133087 \n                   AirYards             YardsAfterCatch \n                          0                           0 \n                      QBHit                PassLocation \n                          0                      133087 \n         InterceptionThrown                 Interceptor \n                          0                      225465 \n                     Rusher                   Rusher_ID \n                     161687                           0 \n                RushAttempt                 RunLocation \n                          0                      162276 \n                     RunGap                    Receiver \n                     180006                      136219 \n                Receiver_ID                   Reception \n                          0                           0 \n               ReturnResult                    Returner \n                     216233                      215139 \n             BlockingPlayer                    Tackler1 \n                     227856                       94492 \n                   Tackler2             FieldGoalResult \n                     201017                      222763 \n          FieldGoalDistance                      Fumble \n                     222832                           0 \n                RecFumbTeam               RecFumbPlayer \n                     225566                      225566 \n                       Sack            Challenge.Replay \n                          0                           0 \n           ChalReplayResult            Accepted.Penalty \n                     225855                           0 \n              PenalizedTeam                 PenaltyType \n                     210968                      218592 \n            PenalizedPlayer               Penalty.Yards \n                     211616                           0 \n               PosTeamScore                DefTeamScore \n                      15084                       15084 \n                  ScoreDiff                AbsScoreDiff \n                      14017                       15084 \n                   HomeTeam                    AwayTeam \n                          0                           0 \n          Timeout_Indicator                Timeout_Team \n                          0                           0 \n       posteam_timeouts_pre  HomeTimeouts_Remaining_Pre \n                          0                           0 \n AwayTimeouts_Remaining_Pre HomeTimeouts_Remaining_Post \n                          0                           0 \nAwayTimeouts_Remaining_Post               No_Score_Prob \n                          0                          99 \n        Opp_Field_Goal_Prob             Opp_Safety_Prob \n                         99                          99 \n         Opp_Touchdown_Prob             Field_Goal_Prob \n                         99                          99 \n                Safety_Prob              Touchdown_Prob \n                         99                          99 \n               ExPoint_Prob               TwoPoint_Prob \n                          0                           0 \n                     ExpPts                         EPA \n                         99                         198 \n                     airEPA                      yacEPA \n                     137833                      137894 \n                Home_WP_pre                 Away_WP_pre \n                      14015                       14015 \n               Home_WP_post                Away_WP_post \n                      14925                       14925 \n                   Win_Prob                         WPA \n                      14045                        3095 \n                     airWPA                      yacWPA \n                     137898                      138050 \n                     Season \n                          0 \n\nnames(NFL_data)\n\n  [1] \"Date\"                        \"GameID\"                     \n  [3] \"Drive\"                       \"qtr\"                        \n  [5] \"down\"                        \"time\"                       \n  [7] \"TimeUnder\"                   \"TimeSecs\"                   \n  [9] \"PlayTimeDiff\"                \"SideofField\"                \n [11] \"yrdln\"                       \"yrdline100\"                 \n [13] \"ydstogo\"                     \"ydsnet\"                     \n [15] \"GoalToGo\"                    \"FirstDown\"                  \n [17] \"posteam\"                     \"DefensiveTeam\"              \n [19] \"desc\"                        \"PlayAttempted\"              \n [21] \"Yards.Gained\"                \"sp\"                         \n [23] \"Touchdown\"                   \"ExPointResult\"              \n [25] \"TwoPointConv\"                \"Safety\"                     \n [27] \"Onsidekick\"                  \"PuntResult\"                 \n [29] \"PlayType\"                    \"Passer\"                     \n [31] \"Passer_ID\"                   \"PassAttempt\"                \n [33] \"PassOutcome\"                 \"PassLength\"                 \n [35] \"AirYards\"                    \"YardsAfterCatch\"            \n [37] \"QBHit\"                       \"PassLocation\"               \n [39] \"InterceptionThrown\"          \"Interceptor\"                \n [41] \"Rusher\"                      \"Rusher_ID\"                  \n [43] \"RushAttempt\"                 \"RunLocation\"                \n [45] \"RunGap\"                      \"Receiver\"                   \n [47] \"Receiver_ID\"                 \"Reception\"                  \n [49] \"ReturnResult\"                \"Returner\"                   \n [51] \"BlockingPlayer\"              \"Tackler1\"                   \n [53] \"Tackler2\"                    \"FieldGoalResult\"            \n [55] \"FieldGoalDistance\"           \"Fumble\"                     \n [57] \"RecFumbTeam\"                 \"RecFumbPlayer\"              \n [59] \"Sack\"                        \"Challenge.Replay\"           \n [61] \"ChalReplayResult\"            \"Accepted.Penalty\"           \n [63] \"PenalizedTeam\"               \"PenaltyType\"                \n [65] \"PenalizedPlayer\"             \"Penalty.Yards\"              \n [67] \"PosTeamScore\"                \"DefTeamScore\"               \n [69] \"ScoreDiff\"                   \"AbsScoreDiff\"               \n [71] \"HomeTeam\"                    \"AwayTeam\"                   \n [73] \"Timeout_Indicator\"           \"Timeout_Team\"               \n [75] \"posteam_timeouts_pre\"        \"HomeTimeouts_Remaining_Pre\" \n [77] \"AwayTimeouts_Remaining_Pre\"  \"HomeTimeouts_Remaining_Post\"\n [79] \"AwayTimeouts_Remaining_Post\" \"No_Score_Prob\"              \n [81] \"Opp_Field_Goal_Prob\"         \"Opp_Safety_Prob\"            \n [83] \"Opp_Touchdown_Prob\"          \"Field_Goal_Prob\"            \n [85] \"Safety_Prob\"                 \"Touchdown_Prob\"             \n [87] \"ExPoint_Prob\"                \"TwoPoint_Prob\"              \n [89] \"ExpPts\"                      \"EPA\"                        \n [91] \"airEPA\"                      \"yacEPA\"                     \n [93] \"Home_WP_pre\"                 \"Away_WP_pre\"                \n [95] \"Home_WP_post\"                \"Away_WP_post\"               \n [97] \"Win_Prob\"                    \"WPA\"                        \n [99] \"airWPA\"                      \"yacWPA\"                     \n[101] \"Season\"                     \n\n\n\n\nThere are a couple things off the top of my head I’d be interested in. One is the percent of 2 point conversions, because there are a lot of times I question the decision of these and also I know 2 point attempt rates have been increasing. Another is TJ Watt’s stats compared to other defensive players because I think he gets snubbed every year for DPOY.\nHere I am just listing out the variables that I think I will be most interested in so I can subset the data set down to it.\n\nsp = Binary indicatior for whether or not a score occured on the play\nyrdln = String indicating the current field position for a given play\ndesc = Detailed string description for the given play play_type = String indicating the type of play: pass (includes sacks), run (includes scrambles), punt, field_goal, kickoff, extra_point, qb_kneel, qb_spike, no_play (timeouts and penalties), and missing for rows indicating end of play.\nyards.gained = Numeric yards gained (or lost) for the given play.\nyrdline100 = Numeric distance in the number of yards from the opponent’s endzone for the posteam.\nhometeam = String abbreviation for the home team.\nawayteam = String abbreviation for the home team.\nposteam = String abbreviation for the team with possession.\nposteamscore = score of the team with possession\ndefteamscore = score of the team on defense\ndown = The down for the given play\nqtr = Quarter of the game (5 is overtime).\nydsnet = Numeric value for total yards gained on the given drive.\nPassLength = String indicator for pass length: short or deep.\ntwopointconv = String indicator for result of two point conversion attempt: success, failure, safety (touchback in defensive endzone is 1 point apparently), or return.\ntimeout_indicator = Binary indicator for whether or not a timeout was called.\ntimeout_team = team that called the timeout\nepa = Expected points added (EPA) by the posteam for the given play: I am not going to mess with the EPA variables at all because it isn’t clear how they were calculated. Same goes for wp (win probability) variables.\npassoutcome= outcome of pass\ninterceptionthrown = binary indicator for if the pass was intercepted\nfumble = binary indicator for if a fumble occured\nsack = Binary indicator for if the play ended in a sack.\ntouchdown = Binary indicator for if the play resulted in a TD.\nTackler1 = String name of one of the players with a tackle assist.\nTackler2 = String name of one of the players with a tackle assist.\n\nI don’t think there is really enough information to fairly judge TJ, but I still think he deserves DPOY.\nI am just going to focus on two-point conversion attempts and 4th and short (less than or equal to two yards) conversions for touchdowns.\n\n\n\nHere lets create some basic contingency tables for the 5 seasons we are interested in and accompaning plots.\n\n#Creating seperate tibbles for each year and removing probabilities variables because I am not interested in them \n\nyr2013&lt;- NFL_data %&gt;% filter(Season == 2013) %&gt;% select(-contains(\"WPA\"), -contains(\"WP\"), -contains(\"EPA\"), -contains(\"Prob\"))\n\nyr2014&lt;- NFL_data %&gt;% filter(Season == 2014) %&gt;% select(-contains(\"WPA\"), -contains(\"WP\"), -contains(\"EPA\"), -contains(\"Prob\"))\n\nyr2015&lt;- NFL_data %&gt;% filter(Season == 2015) %&gt;% select(-contains(\"WPA\"), -contains(\"WP\"), -contains(\"EPA\"), -contains(\"Prob\"))\n\nyr2016&lt;- NFL_data %&gt;% filter(Season == 2016) %&gt;% select(-contains(\"WPA\"), -contains(\"WP\"), -contains(\"EPA\"), -contains(\"Prob\"))\n\nyr2017&lt;- NFL_data %&gt;% filter(Season == 2017) %&gt;% select(-contains(\"WPA\"), -contains(\"WP\"), -contains(\"EPA\"), -contains(\"Prob\"))\n\n#Individual seasons contingency tables for two point conversions \ntwopt_2013 &lt;- table(yr2013$TwoPointConv)\ntwopt_2013\n\n\nFailure Success \n     38      33 \n\ntwopt_2014 &lt;- table(yr2014$TwoPointConv)\ntwopt_2014\n\n\nFailure Success \n     31      28 \n\ntwopt_2015 &lt;- table(yr2015$TwoPointConv)\ntwopt_2015\n\n\nFailure Success \n     46      43 \n\ntwopt_2016 &lt;- table(yr2016$TwoPointConv)\ntwopt_2016\n\n\nFailure Success \n     52      47 \n\ntwopt_2017 &lt;- table(yr2017$TwoPointConv)\ntwopt_2017\n\n\nFailure Success \n     44      33 \n\n#Multiyear contingency table (Can't just use table function because they dont have the same counts)\ntemp_2013 &lt;- c(Failure = 38, Success = 33)\ntemp_2014 &lt;- c(Failure = 31, Success = 28)\ntemp_2015 &lt;- c(Failure = 46, Success = 43)\ntemp_2016 &lt;- c(Failure = 52, Success = 47)\ntemp_2017 &lt;- c(Failure = 44, Success = 33)\n\n  # Combine data\nmultiyr_2ptdata &lt;- rbind(temp_2013, temp_2014, temp_2015, temp_2016, temp_2017)\n\n  # Assign row and column names for better interpretation\nrownames(multiyr_2ptdata) &lt;- c(\"2013\", \"2014\", \"2015\", \"2016\", \"2017\")\ncolnames(multiyr_2ptdata) &lt;- c(\"Failure\", \"Success\")\n\nmultiyr_2ptdata\n\n     Failure Success\n2013      38      33\n2014      31      28\n2015      46      43\n2016      52      47\n2017      44      33\n\n#barplot of data to view any trends\nmulti_2ptdata&lt;- as.data.frame(multiyr_2ptdata)\n  #Adding column for the year \nmulti_2ptdata$year &lt;- rownames(multiyr_2ptdata)\n  #reshaping for ggplot, i like this function from reshape2\n  multi_2pt_long&lt;- melt(multi_2ptdata, id.vars = \"year\")\n  #plotting\n  ggplot(multi_2pt_long, aes(x = year, y = value, fill = variable)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = \"Two-Point Conversion Successes and Failures by Year\",\n       x = \"Year\",\n       y = \"Count\") +\n  scale_fill_manual(values = c(\"Failure\" = \"red\", \"Success\" = \"green\")) +\n  theme_minimal()\n\n\n\n#Definitely seems to have a slightly positive trend in attempts! \n\n\n\n\n\n\n\nfourth_2013&lt;- yr2013 %&gt;% filter(down == 4, yrdline100 &lt;= 2)\nfourth_2014&lt;- yr2014 %&gt;% filter(down == 4, yrdline100 &lt;= 2)\nfourth_2015&lt;- yr2015 %&gt;% filter(down == 4, yrdline100 &lt;= 2)\nfourth_2016&lt;- yr2016 %&gt;% filter(down == 4, yrdline100 &lt;= 2)\nfourth_2017&lt;- yr2017 %&gt;% filter(down == 4, yrdline100 &lt;= 2)\n\ntable(fourth_2013$Touchdown)\n\n\n 0  1 \n67 23 \n\ntable(fourth_2014$Touchdown)\n\n\n 0  1 \n52 13 \n\ntable(fourth_2015$Touchdown)\n\n\n 0  1 \n48 16 \n\ntable(fourth_2016$Touchdown)\n\n\n 0  1 \n46 19 \n\ntable(fourth_2017$Touchdown)\n\n\n 0  1 \n47 16 \n\n#Multiyear contingency table (Can't just use table function because they dont have the same counts)\nfour_temp_2013 &lt;- c(Failure = 67, Success = 23)\nfour_temp_2014 &lt;- c(Failure = 52, Success = 13)\nfour_temp_2015 &lt;- c(Failure = 48, Success = 16)\nfour_temp_2016 &lt;- c(Failure = 46, Success = 19)\nfour_temp_2017 &lt;- c(Failure = 47, Success = 16)\n\n  # Combine data\nmultiyr_fourthdata &lt;- rbind(four_temp_2013, four_temp_2014, four_temp_2015, four_temp_2016, four_temp_2017)\n\n  # Assign row and column names for better interpretation\nrownames(multiyr_fourthdata) &lt;- c(\"2013\", \"2014\", \"2015\", \"2016\", \"2017\")\ncolnames(multiyr_fourthdata) &lt;- c(\"Failure\", \"Success\")\n\nmultiyr_fourthdata\n\n     Failure Success\n2013      67      23\n2014      52      13\n2015      48      16\n2016      46      19\n2017      47      16\n\n#barplot of data to view any trends\nmulti_fourthdata&lt;- as.data.frame(multiyr_fourthdata)\n  #Adding column for the year \nmulti_fourthdata$year &lt;- rownames(multiyr_fourthdata)\n  #reshaping for ggplot, i like this function from reshape2\n  multi_fourth_long&lt;- melt(multi_fourthdata, id.vars = \"year\")\n  #plotting\n  ggplot(multi_fourth_long, aes(x = year, y = value, fill = variable)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = \"Fourth and Short Conversion Successes and Failures by Year\",\n       x = \"Year\",\n       y = \"Count\") +\n  scale_fill_manual(values = c(\"Failure\" = \"red\", \"Success\" = \"green\")) +\n  theme_minimal()\n\n\n\n  #Hey, the amount of failures has decreased at least! Just kidding, this isn't a fair measure because it looks like overall attempts have decreased from 2013-2017. \n\n\n\n\n\nFirst we will view bar plots of the count data of success and failures, then look at conversion rates\n\n  #Filter the dataset for two-point conversion plays\ntwo_point_plays &lt;- NFL_data %&gt;%\n  filter(TwoPointConv %in% c(\"Success\", \"Failure\"))\n\n  #create a contingency table based on team, year, and two-point conversion success\ncontingency_2pt_by_team_year &lt;- table(two_point_plays$posteam, \n                                         two_point_plays$Season, \n                                         two_point_plays$TwoPointConv)\n\n  #View the contingency table\ncontingency_2pt_by_team_year\n\n, ,  = Failure\n\n     \n      2013 2014 2015 2016 2017\n  ARI    3    3    0    3    1\n  ATL    0    1    1    4    1\n  BAL    1    3    2    1    1\n  BUF    0    0    4    0    1\n  CAR    0    1    0    3    1\n  CHI    2    1    3    0    1\n  CIN    1    0    1    0    0\n  CLE    1    1    1    2    0\n  DAL    2    0    0    2    4\n  DEN    1    0    1    1    1\n  DET    3    2    3    1    3\n  GB     4    1    2    2    1\n  HOU    0    0    1    0    3\n  IND    2    3    1    1    1\n  JAC    1    2    4    0    0\n  JAX    0    0    0    0    2\n  KC     0    2    2    0    1\n  LA     0    0    0    1    0\n  LAC    0    0    0    0    1\n  MIA    1    1    1    1    1\n  MIN    1    1    0    2    0\n  NE     2    1    0    1    0\n  NO     1    1    2    3    0\n  NYG    0    0    0    0    4\n  NYJ    0    4    0    0    3\n  OAK    0    0    2    2    0\n  PHI    6    0    0    2    1\n  PIT    1    0    3    6    3\n  SD     0    0    1    1    0\n  SEA    1    1    3    1    3\n  SF     0    0    1    0    1\n  STL    1    0    1    0    0\n  TB     0    0    2    3    5\n  TEN    0    1    3    5    0\n  WAS    3    1    1    4    0\n\n, ,  = Success\n\n     \n      2013 2014 2015 2016 2017\n  ARI    1    2    0    1    1\n  ATL    1    1    1    2    0\n  BAL    3    1    1    3    0\n  BUF    2    2    2    4    0\n  CAR    0    1    0    3    0\n  CHI    5    5    2    0    1\n  CIN    0    1    1    0    0\n  CLE    1    0    2    2    1\n  DAL    1    0    1    0    1\n  DEN    0    2    0    0    2\n  DET    2    1    0    0    2\n  GB     0    1    4    2    1\n  HOU    1    0    2    0    2\n  IND    4    0    1    2    1\n  JAC    0    1    1    0    0\n  JAX    0    0    0    2    3\n  KC     0    0    1    1    0\n  LA     0    0    0    0    0\n  LAC    0    0    0    0    0\n  MIA    0    1    1    1    1\n  MIN    0    4    1    1    2\n  NE     2    0    0    1    2\n  NO     0    0    1    2    1\n  NYG    1    0    1    0    1\n  NYJ    0    0    0    1    1\n  OAK    0    0    1    5    2\n  PHI    3    0    0    4    3\n  PIT    1    4    8    3    2\n  SD     0    0    2    0    0\n  SEA    0    0    1    1    2\n  SF     0    0    1    2    0\n  STL    3    1    1    0    0\n  TB     0    0    1    4    1\n  TEN    0    0    3    0    0\n  WAS    2    0    2    0    0\n\ncontingency2pt_df &lt;- as.data.frame(contingency_2pt_by_team_year)\ncolnames(contingency2pt_df) &lt;- c(\"Team\", \"Year\", \"TwoPointConv\", \"Count\")\n\n#Plotting\ncombined2pt_data &lt;- contingency2pt_df %&gt;%\n  group_by(Team, TwoPointConv) %&gt;%\n  summarise(Count = sum(Count)) %&gt;%\n  ungroup()\n\n`summarise()` has grouped output by 'Team'. You can override using the\n`.groups` argument.\n\nggplot(combined2pt_data, aes(x = Team, y = Count, fill = factor(TwoPointConv))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = \"Two-Point Conversion Success by Team (2013-2017)\",\n       x = \"Team\",\n       y = \"Count of Two-Point Conversions\",\n       fill = \"Two-Point Conversion\") +\n  scale_fill_manual(values = c(\"Failure\" = \"red\", \"Success\" = \"green\"),\n                    labels = c(\"Failure\" = \"Failure\", \"Success\" = \"Success\")) +\n  theme_minimal() +\n  facet_wrap(~ TwoPointConv)  # To separate failures and successes in the plot\n\n\n\n#obviously this isn't the best graph because there are so many teams, but thinking ahead to the app, I am thinking people could filter the graph on their team(s) of choice.\n\n#filter on selected team \nselected_team = \"PIT\"\n  #filter the two-point conversion plays for the selected team\ntwo_point_plays_team &lt;- two_point_plays %&gt;%\n  filter(posteam == selected_team)\n  \ncontingency_2pt_by_year &lt;- table(two_point_plays_team$Season, \n                                     two_point_plays_team$TwoPointConv)\n\n  #Convert the contingency table to a data frame\nselected_team_2pt_df &lt;- as.data.frame(contingency_2pt_by_year)\ncolnames(selected_team_2pt_df) &lt;- c(\"Year\", \"TwoPointConv\", \"Count\")\n\n  #Plotting\nggplot(selected_team_2pt_df, aes(x = factor(Year), y = Count, fill = factor(TwoPointConv))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = paste(\"Two-Point Conversion Success for\", selected_team, \"(2013-2017)\"),\n       x = \"Year\",\n       y = \"Count of Two-Point Conversions\",\n       fill = \"Two-Point Conversion\") +\n  scale_fill_manual(values = c(\"Failure\" = \"red\", \"Success\" = \"green\"),\n                    labels = c(\"Failure\" = \"Failure\", \"Success\" = \"Success\")) +\n  theme_minimal()\n\n\n\n#Who would've thought, highest failure rate the year Matt Canada takes over\n\n# Function to calculate conversion rates for each team by year\ncalculate_twopt_conv &lt;- function(data, selected_teams) {\n  data %&gt;% \n  mutate(TwoPointConv = ifelse(TwoPointConv == \"Success\", 1, 0)) %&gt;% \n    filter(posteam %in% selected_teams & !is.na(TwoPointConv)) %&gt;% \n    group_by(Season,posteam) %&gt;% \n    summarise(TotalAttempts = n(),\n              Successful = sum(TwoPointConv, na.rm = TRUE),\n              ConversionRate = Successful/TotalAttempts,\n              Type = \"Two-Point Conversion\") %&gt;%\n    mutate(Team=posteam) %&gt;% select(-posteam)\n}\n\n#testing function \ncalculate_twopt_conv(NFL_data,selected_teams = c(\"PIT\",\"CLE\"))\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 10 × 6\n# Groups:   Season [5]\n   Season TotalAttempts Successful ConversionRate Type                 Team \n    &lt;dbl&gt;         &lt;int&gt;      &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;\n 1   2013             2          1          0.5   Two-Point Conversion CLE  \n 2   2013             2          1          0.5   Two-Point Conversion PIT  \n 3   2014             1          0          0     Two-Point Conversion CLE  \n 4   2014             4          4          1     Two-Point Conversion PIT  \n 5   2015             3          2          0.667 Two-Point Conversion CLE  \n 6   2015            11          8          0.727 Two-Point Conversion PIT  \n 7   2016             4          2          0.5   Two-Point Conversion CLE  \n 8   2016             9          3          0.333 Two-Point Conversion PIT  \n 9   2017             1          1          1     Two-Point Conversion CLE  \n10   2017             5          2          0.4   Two-Point Conversion PIT  \n\n\n\n\n\nFirst we will view bar plots of the count data of success and failures, then look at conversion rates\n\n# Filter the dataset for fourth down plays\nfourth_down_plays &lt;- NFL_data %&gt;%\n  filter(down == 4 & yrdline100 &lt;= 2) \n\n# Create a contingency table based on team, year, and touchdown success\ncontingency_4th_by_team_year &lt;- table(fourth_down_plays$posteam, \n                                         fourth_down_plays$Season, \n                                         fourth_down_plays$Touchdown)\n\n# View the contingency table\ncontingency_4th_by_team_year\n\n, ,  = 0\n\n     \n      2013 2014 2015 2016 2017\n  ARI    0    0    1    0    3\n  ATL    5    2    3    1    4\n  BAL    1    3    3    1    1\n  BUF    4    0    3    3    4\n  CAR    1    0    3    1    3\n  CHI    3    2    2    0    2\n  CIN    1    1    1    1    0\n  CLE    2    0    1    1    1\n  DAL    2    0    2    0    1\n  DEN    2    4    3    2    2\n  DET    2    2    1    0    3\n  GB     3    4    3    3    0\n  HOU    3    1    2    2    1\n  IND    0    2    0    2    1\n  JAC    1    0    3    0    0\n  JAX    0    0    0    0    1\n  KC     3    2    0    1    1\n  LA     0    0    0    2    1\n  LAC    0    0    0    0    2\n  MIA    2    3    3    0    0\n  MIN    0    1    1    2    2\n  NE     4    5    1    3    0\n  NO     4    3    1    3    2\n  NYG    1    3    2    1    2\n  NYJ    2    0    1    1    1\n  OAK    3    0    0    4    1\n  PHI    2    2    0    5    1\n  PIT    0    1    3    0    2\n  SD     3    1    0    1    0\n  SEA    3    4    0    1    1\n  SF     2    2    1    0    1\n  STL    2    1    1    0    0\n  TB     0    0    0    0    1\n  TEN    3    2    1    1    1\n  WAS    3    1    2    4    1\n\n, ,  = 1\n\n     \n      2013 2014 2015 2016 2017\n  ARI    1    0    0    0    0\n  ATL    0    2    0    1    0\n  BAL    1    0    1    1    0\n  BUF    1    0    1    1    1\n  CAR    3    0    0    1    0\n  CHI    1    0    0    1    0\n  CIN    3    1    1    1    1\n  CLE    2    0    0    0    0\n  DAL    0    2    0    0    0\n  DEN    2    0    1    0    0\n  DET    1    1    0    3    0\n  GB     0    1    0    0    0\n  HOU    0    1    0    1    0\n  IND    1    1    1    2    0\n  JAC    1    0    1    0    0\n  JAX    0    0    0    0    2\n  KC     0    0    1    0    0\n  LA     0    0    0    0    1\n  LAC    0    0    0    0    1\n  MIA    0    0    0    0    0\n  MIN    0    1    1    0    0\n  NE     0    0    1    1    1\n  NO     0    1    1    3    1\n  NYG    0    1    1    0    0\n  NYJ    1    0    0    0    1\n  OAK    1    1    0    1    0\n  PHI    1    0    1    1    1\n  PIT    1    0    0    0    1\n  SD     0    0    1    0    0\n  SEA    1    0    0    0    1\n  SF     0    0    0    1    3\n  STL    0    0    0    0    0\n  TB     0    0    0    0    1\n  TEN    1    0    2    0    0\n  WAS    0    0    1    0    0\n\ncontingency4th_df &lt;- as.data.frame(contingency_4th_by_team_year)\ncolnames(contingency4th_df) &lt;- c(\"Team\", \"Year\", \"Touchdown\", \"Count\")\n\n#Plotting\ncombined4th_data &lt;- contingency4th_df %&gt;%\n  group_by(Team, Touchdown) %&gt;%\n  summarise(Count = sum(Count)) %&gt;%\n  ungroup()\n\n`summarise()` has grouped output by 'Team'. You can override using the\n`.groups` argument.\n\nggplot(combined4th_data, aes(x = Team, y = Count, fill = factor(Touchdown))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = \"Fourth Down Touchdown Success by Team (2013-2017)\",\n       x = \"Team\",\n       y = \"Count of Touchdowns\",\n       fill = \"Touchdown\") +\n  scale_fill_manual(values = c(\"0\" = \"red\", \"1\" = \"green\"),\n                    labels = c(\"0\" = \"Failure\", \"1\" = \"Success\")) +\n  theme_minimal() +\n  facet_wrap(~ Touchdown)  # To separate failures and successes in the plot\n\n\n\n#Again, let's do this just with one team.. \n\n  #Filter the dataset for fourth down plays for the selected team\nfourth_down_plays_team &lt;- fourth_down_plays %&gt;%\n  filter(posteam == selected_team)\n\n  #Create a contingency table based on touchdown success for the team\ncontingency4th_table_by_team &lt;- table(fourth_down_plays_team$Season, fourth_down_plays_team$Touchdown)\n\ncontingency4th_table_by_team\n\n      \n       0 1\n  2013 0 1\n  2014 1 0\n  2015 3 0\n  2017 2 1\n\n  #Convert contingency table to a data frame for easier manipulation\nselected_team_4th_df &lt;- as.data.frame(contingency4th_table_by_team)\ncolnames(selected_team_4th_df) &lt;- c(\"Season\", \"Touchdown\", \"Count\")\n\n  #plotting\nggplot(selected_team_4th_df, aes(x = factor(Season), y = Count, fill = factor(Touchdown))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = paste(\"Fourth Down Touchdown Success for\", selected_team, \"(2013-2017)\"),\n       x = \"Season\",\n       y = \"Count of Fourth Down Attempts\",\n       fill = \"Touchdown Outcome\") +\n  scale_fill_manual(values = c(\"0\" = \"red\", \"1\" = \"green\"),\n                    labels = c(\"0\" = \"Failure\", \"1\" = \"Success\")) +\n  theme_minimal()\n\n\n\n##### Function for calculating 4th and short conversion rates for each team by year\ncalculate_4thdown_conv &lt;- function(data, selected_teams) {\n  data %&gt;%\n    filter(posteam %in% selected_teams & down == 4 & yrdline100 &lt;=2) %&gt;%\n    group_by(Season, posteam) %&gt;%\n    summarise(TotalAttempts = n(),\n              Successful = sum(Touchdown == 1, na.rm = TRUE),\n              ConversionRate = Successful / TotalAttempts,\n              Type = \"Fourth Down Conversion\") %&gt;% \n    mutate(Team = posteam) %&gt;% select(-posteam)\n}\n\n#testing function \ncalculate_4thdown_conv(NFL_data, c(\"PIT\",\"CLE\"))\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 8 × 6\n# Groups:   Season [5]\n  Season TotalAttempts Successful ConversionRate Type                   Team \n   &lt;dbl&gt;         &lt;int&gt;      &lt;int&gt;          &lt;dbl&gt; &lt;chr&gt;                  &lt;chr&gt;\n1   2013             4          2          0.5   Fourth Down Conversion CLE  \n2   2013             1          1          1     Fourth Down Conversion PIT  \n3   2014             1          0          0     Fourth Down Conversion PIT  \n4   2015             1          0          0     Fourth Down Conversion CLE  \n5   2015             3          0          0     Fourth Down Conversion PIT  \n6   2016             1          0          0     Fourth Down Conversion CLE  \n7   2017             1          0          0     Fourth Down Conversion CLE  \n8   2017             3          1          0.333 Fourth Down Conversion PIT  \n\n\n\n\n\nThese allow visual team comparisons of 2 point conversion rates and fourth and short conversion rates through the 2013-2017 seasons.\n\n#fourth down conversion rates needed for plot \ncalculate_4thdown_conv(NFL_data, c(\"PIT\",\"BAL\",\"CLE\",\"CIN\")) -&gt; AFCnorth\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\n #Create the line plot\nfourth_line_plot &lt;- ggplot(AFCnorth, aes(x = Season, y = ConversionRate, color = Team, group = Team)) +\n  geom_line(size = 1) +  # Line for each team\n  geom_point(size = 3) +  # Points at each season\n  labs(title = \"Fourth Down Conversion Rates by Team\",\n       x = \"Season\",\n       y = \"Conversion Rate\",\n       color = \"Team\") +\n  theme_minimal()\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n# Display the plot\nprint(fourth_line_plot)\n\n\n\n########## 2 point conversion rates \ncalculate_twopt_conv(NFL_data, c(\"KC\",\"JAX\")) -&gt;KCvJAX\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\n  #Create the line plot\nline_plot_2pt &lt;- ggplot(KCvJAX, aes(x = Season, y = ConversionRate, color = Team, group = Team)) +\n  geom_line(size = 1) +  # Line for each team\n  geom_point(size = 3) +  # Points at each season\n  labs(title = \"Two-Point Conversion Rates by Team\",\n       x = \"Season\",\n       y = \"Conversion Rate\",\n       color = \"Team\") +\n  theme_minimal()\n\n# Display the plot\nprint(line_plot_2pt)\n\n\n\n\n\n\n\n\n#Going to use the AFC North Teams again \n# Get conversion rates for two-point and fourth down for multiple teams\nAFCN_two_point_data &lt;- calculate_twopt_conv(NFL_data, c(\"PIT\",\"BAL\",\"CLE\",\"CIN\"))\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\nAFCN_fourth_down_data &lt;- calculate_4thdown_conv(NFL_data, c(\"PIT\",\"BAL\",\"CLE\",\"CIN\"))\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\n#Combining datasets \nAFCN_all &lt;- bind_rows(AFCN_fourth_down_data,AFCN_two_point_data)\n\n#Plotting\nggplot(AFCN_all, aes(x=Season, y=ConversionRate, color= Team, linetype = Type, group = interaction(Team, Type))) +\n  geom_smooth(se=FALSE, size = 1.2) + #smoothed lines\n  geom_text(data = AFCN_all %&gt;% group_by(Team,Type) %&gt;% slice_max(Season),\n            aes(label=Team), hjust=1.2,size = 4) + #add team labels at the end of each line \n  labs(title= \"Two-point and Fourth Down Conversion Rates\",\n       x = \"Season\",\n       y = \"Conversion Rate\",\n       color = \"Team\",\n       linetype = \"Conversion Type\") + \n  scale_x_continuous(breaks = 2013:2017) + #setting axis for the 2013-2017 seasons \n  theme_minimal()\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 3.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 9.1204\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 1.01\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 1.0201\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\n\n\n\n\n\n\n#Function to summarize numeric variables for specific team(s) \ncalculate_team_summary&lt;- function(data, selected_teams, quantitative_vars) {\n  data %&gt;% \n    filter(posteam %in% selected_teams) %&gt;% #filter for selected team(s)\n    group_by(posteam) %&gt;% #group by team\n    summarise(across(\n      all_of(quantitative_vars), #i am thinking in app i will give options for user\n      list(mean = ~mean(.x, na.rm = TRUE), sd = ~sd(.x, na.rm = TRUE), median = ~median(.x, na.rm= TRUE))\n    )) %&gt;% \n    ungroup()\n}\n\n#Example usage \ncalculate_team_summary(data = NFL_data, selected_teams = c(\"PIT\",\"CLE\"), quantitative_vars = c(\"yrdline100\", \"FieldGoalDistance\"))\n\n# A tibble: 2 × 7\n  posteam yrdline100_mean yrdline100_sd yrdline100_median FieldGoalDistance_mean\n  &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;                  &lt;dbl&gt;\n1 CLE                52.0          25.0                55                   37.3\n2 PIT                48.7          25.5                50                   36.6\n# ℹ 2 more variables: FieldGoalDistance_sd &lt;dbl&gt;,\n#   FieldGoalDistance_median &lt;dbl&gt;"
  },
  {
    "objectID": "data_analysis.html#nfl-play-by-play-data-analysis",
    "href": "data_analysis.html#nfl-play-by-play-data-analysis",
    "title": "NFL_Data_Analysis",
    "section": "",
    "text": "In this document we will do some exploratory data analysis of our data before creating an app.\nI found descriptions for the variable names here.\n\nNFL_data&lt;- read_csv(\"NFL_Play_by_Play_2009-2017(v4).csv\") \n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 407688 Columns: 102\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (34): SideofField, posteam, DefensiveTeam, desc, ExPointResult, TwoPoin...\ndbl  (64): GameID, Drive, qtr, down, TimeUnder, TimeSecs, PlayTimeDiff, yrdl...\nlgl   (2): DefTwoPoint, BlockingPlayer\ndate  (1): Date\ntime  (1): time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhead(NFL_data)\n\n# A tibble: 6 × 102\n  Date           GameID Drive   qtr  down time   TimeUnder TimeSecs PlayTimeDiff\n  &lt;date&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;time&gt;     &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;\n1 2009-09-10 2009091000     1     1    NA 15:00         15     3600            0\n2 2009-09-10 2009091000     1     1     1 14:53         15     3593            7\n3 2009-09-10 2009091000     1     1     2 14:16         15     3556           37\n4 2009-09-10 2009091000     1     1     3 13:35         14     3515           41\n5 2009-09-10 2009091000     1     1     4 13:27         14     3507            8\n6 2009-09-10 2009091000     2     1     1 13:16         14     3496           11\n# ℹ 93 more variables: SideofField &lt;chr&gt;, yrdln &lt;dbl&gt;, yrdline100 &lt;dbl&gt;,\n#   ydstogo &lt;dbl&gt;, ydsnet &lt;dbl&gt;, GoalToGo &lt;dbl&gt;, FirstDown &lt;dbl&gt;,\n#   posteam &lt;chr&gt;, DefensiveTeam &lt;chr&gt;, desc &lt;chr&gt;, PlayAttempted &lt;dbl&gt;,\n#   Yards.Gained &lt;dbl&gt;, sp &lt;dbl&gt;, Touchdown &lt;dbl&gt;, ExPointResult &lt;chr&gt;,\n#   TwoPointConv &lt;chr&gt;, DefTwoPoint &lt;lgl&gt;, Safety &lt;dbl&gt;, Onsidekick &lt;dbl&gt;,\n#   PuntResult &lt;chr&gt;, PlayType &lt;chr&gt;, Passer &lt;chr&gt;, Passer_ID &lt;chr&gt;,\n#   PassAttempt &lt;dbl&gt;, PassOutcome &lt;chr&gt;, PassLength &lt;chr&gt;, AirYards &lt;dbl&gt;, …\n\n#Imported as a tibble. Has 102 different variables \nhead(str(NFL_data))\n\nspc_tbl_ [407,688 × 102] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Date                       : Date[1:407688], format: \"2009-09-10\" \"2009-09-10\" ...\n $ GameID                     : num [1:407688] 2.01e+09 2.01e+09 2.01e+09 2.01e+09 2.01e+09 ...\n $ Drive                      : num [1:407688] 1 1 1 1 1 2 2 2 2 3 ...\n $ qtr                        : num [1:407688] 1 1 1 1 1 1 1 1 1 1 ...\n $ down                       : num [1:407688] NA 1 2 3 4 1 2 3 4 1 ...\n $ time                       : 'hms' num [1:407688] 15:00:00 14:53:00 14:16:00 13:35:00 ...\n  ..- attr(*, \"units\")= chr \"secs\"\n $ TimeUnder                  : num [1:407688] 15 15 15 14 14 14 13 13 12 12 ...\n $ TimeSecs                   : num [1:407688] 3600 3593 3556 3515 3507 ...\n $ PlayTimeDiff               : num [1:407688] 0 7 37 41 8 11 36 29 37 10 ...\n $ SideofField                : chr [1:407688] \"TEN\" \"PIT\" \"PIT\" \"PIT\" ...\n $ yrdln                      : num [1:407688] 30 42 47 44 44 2 2 6 4 43 ...\n $ yrdline100                 : num [1:407688] 30 58 53 56 56 98 98 94 96 43 ...\n $ ydstogo                    : num [1:407688] 0 10 5 8 8 10 10 6 8 10 ...\n $ ydsnet                     : num [1:407688] 0 5 2 2 2 0 4 2 2 3 ...\n $ GoalToGo                   : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ FirstDown                  : num [1:407688] NA 0 0 0 1 0 0 0 1 0 ...\n $ posteam                    : chr [1:407688] \"PIT\" \"PIT\" \"PIT\" \"PIT\" ...\n $ DefensiveTeam              : chr [1:407688] \"TEN\" \"TEN\" \"TEN\" \"TEN\" ...\n $ desc                       : chr [1:407688] \"R.Bironas kicks 67 yards from TEN 30 to PIT 3. S.Logan to PIT 42 for 39 yards (M.Griffin).\" \"(14:53) B.Roethlisberger pass short left to H.Ward to PIT 47 for 5 yards (C.Hope).\" \"(14:16) W.Parker right end to PIT 44 for -3 yards (S.Tulloch).\" \"(13:35) (Shotgun) B.Roethlisberger pass incomplete deep right to M.Wallace. COVERAGE BY #24 HOPE\" ...\n $ PlayAttempted              : num [1:407688] 1 1 1 1 1 1 1 1 1 1 ...\n $ Yards.Gained               : num [1:407688] 39 5 -3 0 0 0 4 -2 11 3 ...\n $ sp                         : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ Touchdown                  : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ ExPointResult              : chr [1:407688] NA NA NA NA ...\n $ TwoPointConv               : chr [1:407688] NA NA NA NA ...\n $ DefTwoPoint                : logi [1:407688] NA NA NA NA NA NA ...\n $ Safety                     : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ Onsidekick                 : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ PuntResult                 : chr [1:407688] NA NA NA NA ...\n $ PlayType                   : chr [1:407688] \"Kickoff\" \"Pass\" \"Run\" \"Pass\" ...\n $ Passer                     : chr [1:407688] NA \"B.Roethlisberger\" NA \"B.Roethlisberger\" ...\n $ Passer_ID                  : chr [1:407688] \"None\" \"00-0022924\" \"None\" \"00-0022924\" ...\n $ PassAttempt                : num [1:407688] 0 1 0 1 0 0 1 0 0 1 ...\n $ PassOutcome                : chr [1:407688] NA \"Complete\" NA \"Incomplete Pass\" ...\n $ PassLength                 : chr [1:407688] NA \"Short\" NA \"Deep\" ...\n $ AirYards                   : num [1:407688] 0 -3 0 34 0 0 3 0 0 -2 ...\n $ YardsAfterCatch            : num [1:407688] 0 8 0 0 0 0 1 0 0 5 ...\n $ QBHit                      : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ PassLocation               : chr [1:407688] NA \"left\" NA \"right\" ...\n $ InterceptionThrown         : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ Interceptor                : chr [1:407688] NA NA NA NA ...\n $ Rusher                     : chr [1:407688] NA NA \"W.Parker\" NA ...\n $ Rusher_ID                  : chr [1:407688] \"None\" \"None\" \"00-0022250\" \"None\" ...\n $ RushAttempt                : num [1:407688] 0 0 1 0 0 1 0 1 0 0 ...\n $ RunLocation                : chr [1:407688] NA NA \"right\" NA ...\n $ RunGap                     : chr [1:407688] NA NA \"end\" NA ...\n $ Receiver                   : chr [1:407688] NA \"H.Ward\" NA \"M.Wallace\" ...\n $ Receiver_ID                : chr [1:407688] \"None\" \"00-0017162\" \"None\" \"00-0026901\" ...\n $ Reception                  : num [1:407688] 0 1 0 0 0 0 1 0 0 1 ...\n $ ReturnResult               : chr [1:407688] NA NA NA NA ...\n $ Returner                   : chr [1:407688] \"S.Logan\" NA NA NA ...\n $ BlockingPlayer             : logi [1:407688] NA NA NA NA NA NA ...\n $ Tackler1                   : chr [1:407688] \"M.Griffin\" \"C.Hope\" \"S.Tulloch\" NA ...\n $ Tackler2                   : chr [1:407688] NA NA NA NA ...\n $ FieldGoalResult            : chr [1:407688] NA NA NA NA ...\n $ FieldGoalDistance          : num [1:407688] NA NA NA NA NA NA NA NA NA NA ...\n $ Fumble                     : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ RecFumbTeam                : chr [1:407688] NA NA NA NA ...\n $ RecFumbPlayer              : chr [1:407688] NA NA NA NA ...\n $ Sack                       : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ Challenge.Replay           : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ ChalReplayResult           : chr [1:407688] NA NA NA NA ...\n $ Accepted.Penalty           : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ PenalizedTeam              : chr [1:407688] NA NA NA NA ...\n $ PenaltyType                : chr [1:407688] NA NA NA NA ...\n $ PenalizedPlayer            : chr [1:407688] NA NA NA NA ...\n $ Penalty.Yards              : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ PosTeamScore               : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ DefTeamScore               : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ ScoreDiff                  : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ AbsScoreDiff               : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ HomeTeam                   : chr [1:407688] \"PIT\" \"PIT\" \"PIT\" \"PIT\" ...\n $ AwayTeam                   : chr [1:407688] \"TEN\" \"TEN\" \"TEN\" \"TEN\" ...\n $ Timeout_Indicator          : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ Timeout_Team               : chr [1:407688] \"None\" \"None\" \"None\" \"None\" ...\n $ posteam_timeouts_pre       : num [1:407688] 3 3 3 3 3 3 3 3 3 3 ...\n $ HomeTimeouts_Remaining_Pre : num [1:407688] 3 3 3 3 3 3 3 3 3 3 ...\n $ AwayTimeouts_Remaining_Pre : num [1:407688] 3 3 3 3 3 3 3 3 3 3 ...\n $ HomeTimeouts_Remaining_Post: num [1:407688] 3 3 3 3 3 3 3 3 3 3 ...\n $ AwayTimeouts_Remaining_Post: num [1:407688] 3 3 3 3 3 3 3 3 3 3 ...\n $ No_Score_Prob              : num [1:407688] 0.001506 0.000969 0.001057 0.001434 0.001861 ...\n $ Opp_Field_Goal_Prob        : num [1:407688] 0.18 0.109 0.105 0.149 0.213 ...\n $ Opp_Safety_Prob            : num [1:407688] 0.006639 0.001061 0.000981 0.001944 0.003279 ...\n $ Opp_Touchdown_Prob         : num [1:407688] 0.281 0.169 0.163 0.235 0.322 ...\n $ Field_Goal_Prob            : num [1:407688] 0.214 0.294 0.305 0.289 0.245 ...\n $ Safety_Prob                : num [1:407688] 0.00359 0.00364 0.00383 0.00478 0.0064 ...\n $ Touchdown_Prob             : num [1:407688] 0.314 0.423 0.421 0.319 0.208 ...\n $ ExPoint_Prob               : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ TwoPoint_Prob              : num [1:407688] 0 0 0 0 0 0 0 0 0 0 ...\n $ ExpPts                     : num [1:407688] 0.324 2.338 2.416 1.013 -0.699 ...\n $ EPA                        : num [1:407688] 2.0145 0.0779 -1.4028 -1.7126 2.0978 ...\n $ airEPA                     : num [1:407688] NA -1.07 NA 3.32 NA ...\n $ yacEPA                     : num [1:407688] NA 1.15 NA -5.03 NA ...\n $ Home_WP_pre                : num [1:407688] 0.486 0.546 0.551 0.511 0.461 ...\n $ Away_WP_pre                : num [1:407688] 0.514 0.454 0.449 0.489 0.539 ...\n $ Home_WP_post               : num [1:407688] 0.546 0.551 0.511 0.461 0.559 ...\n $ Away_WP_post               : num [1:407688] 0.454 0.449 0.489 0.539 0.441 ...\n $ Win_Prob                   : num [1:407688] 0.486 0.546 0.551 0.511 0.461 ...\n $ WPA                        : num [1:407688] 0.06076 0.00465 -0.04029 -0.04958 0.09771 ...\n  [list output truncated]\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Date = col_date(format = \"\"),\n  ..   GameID = col_double(),\n  ..   Drive = col_double(),\n  ..   qtr = col_double(),\n  ..   down = col_double(),\n  ..   time = col_time(format = \"\"),\n  ..   TimeUnder = col_double(),\n  ..   TimeSecs = col_double(),\n  ..   PlayTimeDiff = col_double(),\n  ..   SideofField = col_character(),\n  ..   yrdln = col_double(),\n  ..   yrdline100 = col_double(),\n  ..   ydstogo = col_double(),\n  ..   ydsnet = col_double(),\n  ..   GoalToGo = col_double(),\n  ..   FirstDown = col_double(),\n  ..   posteam = col_character(),\n  ..   DefensiveTeam = col_character(),\n  ..   desc = col_character(),\n  ..   PlayAttempted = col_double(),\n  ..   Yards.Gained = col_double(),\n  ..   sp = col_double(),\n  ..   Touchdown = col_double(),\n  ..   ExPointResult = col_character(),\n  ..   TwoPointConv = col_character(),\n  ..   DefTwoPoint = col_logical(),\n  ..   Safety = col_double(),\n  ..   Onsidekick = col_double(),\n  ..   PuntResult = col_character(),\n  ..   PlayType = col_character(),\n  ..   Passer = col_character(),\n  ..   Passer_ID = col_character(),\n  ..   PassAttempt = col_double(),\n  ..   PassOutcome = col_character(),\n  ..   PassLength = col_character(),\n  ..   AirYards = col_double(),\n  ..   YardsAfterCatch = col_double(),\n  ..   QBHit = col_double(),\n  ..   PassLocation = col_character(),\n  ..   InterceptionThrown = col_double(),\n  ..   Interceptor = col_character(),\n  ..   Rusher = col_character(),\n  ..   Rusher_ID = col_character(),\n  ..   RushAttempt = col_double(),\n  ..   RunLocation = col_character(),\n  ..   RunGap = col_character(),\n  ..   Receiver = col_character(),\n  ..   Receiver_ID = col_character(),\n  ..   Reception = col_double(),\n  ..   ReturnResult = col_character(),\n  ..   Returner = col_character(),\n  ..   BlockingPlayer = col_logical(),\n  ..   Tackler1 = col_character(),\n  ..   Tackler2 = col_character(),\n  ..   FieldGoalResult = col_character(),\n  ..   FieldGoalDistance = col_double(),\n  ..   Fumble = col_double(),\n  ..   RecFumbTeam = col_character(),\n  ..   RecFumbPlayer = col_character(),\n  ..   Sack = col_double(),\n  ..   Challenge.Replay = col_double(),\n  ..   ChalReplayResult = col_character(),\n  ..   Accepted.Penalty = col_double(),\n  ..   PenalizedTeam = col_character(),\n  ..   PenaltyType = col_character(),\n  ..   PenalizedPlayer = col_character(),\n  ..   Penalty.Yards = col_double(),\n  ..   PosTeamScore = col_double(),\n  ..   DefTeamScore = col_double(),\n  ..   ScoreDiff = col_double(),\n  ..   AbsScoreDiff = col_double(),\n  ..   HomeTeam = col_character(),\n  ..   AwayTeam = col_character(),\n  ..   Timeout_Indicator = col_double(),\n  ..   Timeout_Team = col_character(),\n  ..   posteam_timeouts_pre = col_double(),\n  ..   HomeTimeouts_Remaining_Pre = col_double(),\n  ..   AwayTimeouts_Remaining_Pre = col_double(),\n  ..   HomeTimeouts_Remaining_Post = col_double(),\n  ..   AwayTimeouts_Remaining_Post = col_double(),\n  ..   No_Score_Prob = col_double(),\n  ..   Opp_Field_Goal_Prob = col_double(),\n  ..   Opp_Safety_Prob = col_double(),\n  ..   Opp_Touchdown_Prob = col_double(),\n  ..   Field_Goal_Prob = col_double(),\n  ..   Safety_Prob = col_double(),\n  ..   Touchdown_Prob = col_double(),\n  ..   ExPoint_Prob = col_double(),\n  ..   TwoPoint_Prob = col_double(),\n  ..   ExpPts = col_double(),\n  ..   EPA = col_double(),\n  ..   airEPA = col_double(),\n  ..   yacEPA = col_double(),\n  ..   Home_WP_pre = col_double(),\n  ..   Away_WP_pre = col_double(),\n  ..   Home_WP_post = col_double(),\n  ..   Away_WP_post = col_double(),\n  ..   Win_Prob = col_double(),\n  ..   WPA = col_double(),\n  ..   airWPA = col_double(),\n  ..   yacWPA = col_double(),\n  ..   Season = col_double()\n  .. )\n - attr(*, \"problems\")=&lt;externalptr&gt; \n\n\nNULL\n\n#psych::describe(NFL_data)\n#I am going to filter to just a 5 year span, 2012-2017, just because the dataset is so huge and taking a long time to load for a lot of things. \nNFL_data &lt;- NFL_data%&gt;% filter(Season &gt;= 2013) \npsych::describe(NFL_data)\n\n                            vars      n          mean         sd       median\nDate                           1 227856           NaN         NA           NA\nGameID                         2 227856 2015130986.35 1425466.93 2.015111e+09\nDrive                          3 227856         12.25       7.12 1.200000e+01\nqtr                            4 227856          2.58       1.13 3.000000e+00\ndown                           5 193519          2.00       1.01 2.000000e+00\ntime                           6 227729           NaN         NA           NA\nTimeUnder                      7 227856          7.36       4.64 7.000000e+00\nTimeSecs                       8 227729       1694.47    1062.59 1.800000e+03\nPlayTimeDiff                   9 227606         20.43      17.81 1.700000e+01\nSideofField                   10 227559           NaN         NA           NA\nyrdln                         11 227384         28.58      12.79 3.000000e+01\nyrdline100                    12 227384         48.88      24.92 5.000000e+01\nydstogo                       13 227856          7.33       4.90 9.000000e+00\nydsnet                        14 227856         26.38      25.07 2.000000e+01\nGoalToGo                      15 227384          0.05       0.22 0.000000e+00\nFirstDown                     16 211649          0.29       0.45 0.000000e+00\nposteam                       17 213838           NaN         NA           NA\nDefensiveTeam                 18 213838           NaN         NA           NA\ndesc                          19 227856           NaN         NA           NA\nPlayAttempted                 20 227856          1.00       0.00 1.000000e+00\nYards.Gained                  21 227856          4.86       8.94 1.000000e+00\nsp                            22 227856          0.07       0.26 0.000000e+00\nTouchdown                     23 227856          0.03       0.17 0.000000e+00\nExPointResult                 24   5635           NaN         NA           NA\nTwoPointConv                  25    395           NaN         NA           NA\nDefTwoPoint                   26      0           NaN         NA           NA\nSafety                        27 227856          0.00       0.02 0.000000e+00\nOnsidekick                    28 227856          0.00       0.04 0.000000e+00\nPuntResult                    29  12344           NaN         NA           NA\nPlayType                      30 227856           NaN         NA           NA\nPasser                        31  95311           NaN         NA           NA\nPasser_ID                     32 227856           NaN         NA           NA\nPassAttempt                   33 227856          0.42       0.49 0.000000e+00\nPassOutcome                   34  95339           NaN         NA           NA\nPassLength                    35  94769           NaN         NA           NA\nAirYards                      36 227856          3.28       7.52 0.000000e+00\nYardsAfterCatch               37 227856          1.29       4.23 0.000000e+00\nQBHit                         38 227856          0.06       0.23 0.000000e+00\nPassLocation                  39  94769           NaN         NA           NA\nInterceptionThrown            40 227856          0.01       0.10 0.000000e+00\nInterceptor                   41   2391           NaN         NA           NA\nRusher                        42  66169           NaN         NA           NA\nRusher_ID                     43 227856           NaN         NA           NA\nRushAttempt                   44 227856          0.29       0.45 0.000000e+00\nRunLocation                   45  65580           NaN         NA           NA\nRunGap                        46  47850           NaN         NA           NA\nReceiver                      47  91637           NaN         NA           NA\nReceiver_ID                   48 227856           NaN         NA           NA\nReception                     49 227856          0.25       0.44 0.000000e+00\nReturnResult                  50  11623           NaN         NA           NA\nReturner                      51  12717           NaN         NA           NA\nBlockingPlayer                52      0           NaN         NA           NA\nTackler1                      53 133364           NaN         NA           NA\nTackler2                      54  26839           NaN         NA           NA\nFieldGoalResult               55   5093           NaN         NA           NA\nFieldGoalDistance             56   5024         37.87      10.25 3.800000e+01\nFumble                        57 227856          0.01       0.12 0.000000e+00\nRecFumbTeam                   58   2290           NaN         NA           NA\nRecFumbPlayer                 59   2290           NaN         NA           NA\nSack                          60 227856          0.03       0.16 0.000000e+00\nChallenge.Replay              61 227856          0.01       0.09 0.000000e+00\nChalReplayResult              62   2001           NaN         NA           NA\nAccepted.Penalty              63 227856          0.07       0.26 0.000000e+00\nPenalizedTeam                 64  16888           NaN         NA           NA\nPenaltyType                   65   9264           NaN         NA           NA\nPenalizedPlayer               66  16240           NaN         NA           NA\nPenalty.Yards                 67 227856          0.63       2.68 0.000000e+00\nPosTeamScore                  68 212772         10.26       9.39 8.000000e+00\nDefTeamScore                  69 212772         11.54       9.90 1.000000e+01\nScoreDiff                     70 213839         -1.25      10.57 0.000000e+00\nAbsScoreDiff                  71 212772          7.69       7.33 7.000000e+00\nHomeTeam                      72 227856           NaN         NA           NA\nAwayTeam                      73 227856           NaN         NA           NA\nTimeout_Indicator             74 227856          0.04       0.20 0.000000e+00\nTimeout_Team                  75 227856           NaN         NA           NA\nposteam_timeouts_pre          76 227856          2.53       0.78 3.000000e+00\nHomeTimeouts_Remaining_Pre    77 227856          2.55       0.75 3.000000e+00\nAwayTimeouts_Remaining_Pre    78 227856          2.53       0.78 3.000000e+00\nHomeTimeouts_Remaining_Post   79 227856          2.53       0.77 3.000000e+00\nAwayTimeouts_Remaining_Post   80 227856          2.50       0.80 3.000000e+00\nNo_Score_Prob                 81 227757          0.13       0.20 2.000000e-02\nOpp_Field_Goal_Prob           82 227757          0.09       0.07 8.000000e-02\nOpp_Safety_Prob               83 227757          0.00       0.00 0.000000e+00\nOpp_Touchdown_Prob            84 227757          0.14       0.11 1.200000e-01\nField_Goal_Prob               85 227757          0.24       0.16 2.300000e-01\nSafety_Prob                   86 227757          0.00       0.00 0.000000e+00\nTouchdown_Prob                87 227757          0.30       0.17 3.100000e-01\nExPoint_Prob                  88 227856          0.02       0.15 0.000000e+00\nTwoPoint_Prob                 89 227856          0.00       0.02 0.000000e+00\nExpPts                        90 227757          1.56       1.75 1.220000e+00\nEPA                           91 227658          0.03       1.32 0.000000e+00\nairEPA                        92  90023          0.52       1.39 2.900000e-01\nyacEPA                        93  89962         -0.37       1.96 0.000000e+00\nHome_WP_pre                   94 213841          0.54       0.28 5.400000e-01\nAway_WP_pre                   95 213841          0.46       0.28 4.600000e-01\nHome_WP_post                  96 212931          0.54       0.29 5.400000e-01\nAway_WP_post                  97 212931          0.46       0.29 4.600000e-01\nWin_Prob                      98 213811          0.50       0.29 5.000000e-01\nWPA                           99 224761          0.00       0.05 0.000000e+00\nairWPA                       100  89958          0.02       0.06 0.000000e+00\nyacWPA                       101  89806         -0.01       0.07 0.000000e+00\nSeason                       102 227856       2015.00       1.41 2.015000e+03\n                                     min          max      range  skew kurtosis\nDate                                 Inf         -Inf       -Inf    NA       NA\nGameID                       2.01309e+09 2.017123e+09 4032615.00 -0.02    -1.32\nDrive                        1.00000e+00 3.500000e+01      34.00  0.20    -0.92\nqtr                          1.00000e+00 5.000000e+00       4.00  0.00    -1.30\ndown                         1.00000e+00 4.000000e+00       3.00  0.61    -0.79\ntime                                 Inf         -Inf       -Inf    NA       NA\nTimeUnder                    0.00000e+00 1.500000e+01      15.00  0.15    -1.28\nTimeSecs                    -9.00000e+02 3.600000e+03    4500.00  0.03    -1.12\nPlayTimeDiff                 0.00000e+00 9.430000e+02     943.00  5.91   274.64\nSideofField                          Inf         -Inf       -Inf    NA       NA\nyrdln                        1.00000e+00 5.000000e+01      49.00 -0.29    -0.81\nyrdline100                   1.00000e+00 9.900000e+01      98.00 -0.13    -1.03\nydstogo                      0.00000e+00 4.800000e+01      48.00  0.35     0.98\nydsnet                      -8.40000e+01 9.900000e+01     183.00  0.70    -0.56\nGoalToGo                     0.00000e+00 1.000000e+00       1.00  4.15    15.25\nFirstDown                    0.00000e+00 1.000000e+00       1.00  0.92    -1.15\nposteam                              Inf         -Inf       -Inf    NA       NA\nDefensiveTeam                        Inf         -Inf       -Inf    NA       NA\ndesc                                 Inf         -Inf       -Inf    NA       NA\nPlayAttempted                1.00000e+00 1.000000e+00       0.00   NaN      NaN\nYards.Gained                -3.40000e+01 9.900000e+01     133.00  2.95    14.22\nsp                           0.00000e+00 1.000000e+00       1.00  3.31     8.97\nTouchdown                    0.00000e+00 1.000000e+00       1.00  5.59    29.27\nExPointResult                        Inf         -Inf       -Inf    NA       NA\nTwoPointConv                         Inf         -Inf       -Inf    NA       NA\nDefTwoPoint                          Inf         -Inf       -Inf    NA       NA\nSafety                       0.00000e+00 1.000000e+00       1.00 48.94  2393.46\nOnsidekick                   0.00000e+00 1.000000e+00       1.00 26.59   704.83\nPuntResult                           Inf         -Inf       -Inf    NA       NA\nPlayType                             Inf         -Inf       -Inf    NA       NA\nPasser                               Inf         -Inf       -Inf    NA       NA\nPasser_ID                            Inf         -Inf       -Inf    NA       NA\nPassAttempt                  0.00000e+00 1.000000e+00       1.00  0.33    -1.89\nPassOutcome                          Inf         -Inf       -Inf    NA       NA\nPassLength                           Inf         -Inf       -Inf    NA       NA\nAirYards                    -4.10000e+01 6.600000e+01     107.00  2.90    10.16\nYardsAfterCatch             -4.40000e+01 8.800000e+01     132.00  6.22    60.18\nQBHit                        0.00000e+00 1.000000e+00       1.00  3.87    12.98\nPassLocation                         Inf         -Inf       -Inf    NA       NA\nInterceptionThrown           0.00000e+00 1.000000e+00       1.00  9.60    90.11\nInterceptor                          Inf         -Inf       -Inf    NA       NA\nRusher                               Inf         -Inf       -Inf    NA       NA\nRusher_ID                            Inf         -Inf       -Inf    NA       NA\nRushAttempt                  0.00000e+00 1.000000e+00       1.00  0.92    -1.15\nRunLocation                          Inf         -Inf       -Inf    NA       NA\nRunGap                               Inf         -Inf       -Inf    NA       NA\nReceiver                             Inf         -Inf       -Inf    NA       NA\nReceiver_ID                          Inf         -Inf       -Inf    NA       NA\nReception                    0.00000e+00 1.000000e+00       1.00  1.13    -0.73\nReturnResult                         Inf         -Inf       -Inf    NA       NA\nReturner                             Inf         -Inf       -Inf    NA       NA\nBlockingPlayer                       Inf         -Inf       -Inf    NA       NA\nTackler1                             Inf         -Inf       -Inf    NA       NA\nTackler2                             Inf         -Inf       -Inf    NA       NA\nFieldGoalResult                      Inf         -Inf       -Inf    NA       NA\nFieldGoalDistance            1.80000e+01 7.100000e+01      53.00  0.00    -1.00\nFumble                       0.00000e+00 1.000000e+00       1.00  8.41    68.78\nRecFumbTeam                          Inf         -Inf       -Inf    NA       NA\nRecFumbPlayer                        Inf         -Inf       -Inf    NA       NA\nSack                         0.00000e+00 1.000000e+00       1.00  5.75    31.02\nChallenge.Replay             0.00000e+00 1.000000e+00       1.00 10.52   108.60\nChalReplayResult                     Inf         -Inf       -Inf    NA       NA\nAccepted.Penalty             0.00000e+00 1.000000e+00       1.00  3.25     8.57\nPenalizedTeam                        Inf         -Inf       -Inf    NA       NA\nPenaltyType                          Inf         -Inf       -Inf    NA       NA\nPenalizedPlayer                      Inf         -Inf       -Inf    NA       NA\nPenalty.Yards                0.00000e+00 6.600000e+01      66.00  6.04    52.71\nPosTeamScore                 0.00000e+00 5.600000e+01      56.00  0.89     0.44\nDefTeamScore                 0.00000e+00 5.600000e+01      56.00  0.82     0.27\nScoreDiff                   -5.40000e+01 5.300000e+01     107.00 -0.06     1.25\nAbsScoreDiff                 0.00000e+00 5.400000e+01      54.00  1.37     2.20\nHomeTeam                             Inf         -Inf       -Inf    NA       NA\nAwayTeam                             Inf         -Inf       -Inf    NA       NA\nTimeout_Indicator            0.00000e+00 1.000000e+00       1.00  4.63    19.40\nTimeout_Team                         Inf         -Inf       -Inf    NA       NA\nposteam_timeouts_pre         0.00000e+00 3.000000e+00       3.00 -1.69     2.19\nHomeTimeouts_Remaining_Pre  -1.00000e+00 3.000000e+00       4.00 -1.74     2.45\nAwayTimeouts_Remaining_Pre  -1.00000e+00 3.000000e+00       4.00 -1.68     2.19\nHomeTimeouts_Remaining_Post -1.00000e+00 3.000000e+00       4.00 -1.69     2.23\nAwayTimeouts_Remaining_Post -1.00000e+00 3.000000e+00       4.00 -1.63     1.98\nNo_Score_Prob                0.00000e+00 1.000000e+00       1.00  1.97     3.58\nOpp_Field_Goal_Prob          0.00000e+00 3.600000e-01       0.36  0.58    -0.38\nOpp_Safety_Prob              0.00000e+00 3.000000e-02       0.03  2.33     7.55\nOpp_Touchdown_Prob           0.00000e+00 5.000000e-01       0.50  0.52    -0.65\nField_Goal_Prob              0.00000e+00 9.900000e-01       0.99  1.29     4.21\nSafety_Prob                  0.00000e+00 2.000000e-02       0.02 -0.15     1.21\nTouchdown_Prob               0.00000e+00 9.100000e-01       0.91  0.08     0.27\nExPoint_Prob                 0.00000e+00 9.900000e-01       0.99  6.13    35.63\nTwoPoint_Prob                0.00000e+00 4.700000e-01       0.47 23.96   571.85\nExpPts                      -3.84000e+00 6.500000e+00      10.34  0.26    -0.31\nEPA                         -1.34900e+01 9.510000e+00      23.00 -0.26     6.89\nairEPA                      -1.28500e+01 7.350000e+00      20.20  0.55     0.42\nyacEPA                      -1.40000e+01 9.410000e+00      23.41 -1.02     2.62\nHome_WP_pre                  0.00000e+00 1.000000e+00       1.00 -0.14    -0.93\nAway_WP_pre                  0.00000e+00 1.000000e+00       1.00  0.14    -0.93\nHome_WP_post                 0.00000e+00 1.000000e+00       1.00 -0.14    -0.95\nAway_WP_post                 0.00000e+00 1.000000e+00       1.00  0.14    -0.95\nWin_Prob                     0.00000e+00 1.000000e+00       1.00 -0.02    -0.97\nWPA                         -9.80000e-01 9.900000e-01       1.98  0.50    70.60\nairWPA                      -9.90000e-01 9.900000e-01       1.99  1.79    64.53\nyacWPA                      -9.80000e-01 1.000000e+00       1.98 -1.78    34.21\nSeason                       2.01300e+03 2.017000e+03       4.00  0.00    -1.29\n                                 se\nDate                             NA\nGameID                      2986.26\nDrive                          0.01\nqtr                            0.00\ndown                           0.00\ntime                             NA\nTimeUnder                      0.01\nTimeSecs                       2.23\nPlayTimeDiff                   0.04\nSideofField                      NA\nyrdln                          0.03\nyrdline100                     0.05\nydstogo                        0.01\nydsnet                         0.05\nGoalToGo                       0.00\nFirstDown                      0.00\nposteam                          NA\nDefensiveTeam                    NA\ndesc                             NA\nPlayAttempted                  0.00\nYards.Gained                   0.02\nsp                             0.00\nTouchdown                      0.00\nExPointResult                    NA\nTwoPointConv                     NA\nDefTwoPoint                      NA\nSafety                         0.00\nOnsidekick                     0.00\nPuntResult                       NA\nPlayType                         NA\nPasser                           NA\nPasser_ID                        NA\nPassAttempt                    0.00\nPassOutcome                      NA\nPassLength                       NA\nAirYards                       0.02\nYardsAfterCatch                0.01\nQBHit                          0.00\nPassLocation                     NA\nInterceptionThrown             0.00\nInterceptor                      NA\nRusher                           NA\nRusher_ID                        NA\nRushAttempt                    0.00\nRunLocation                      NA\nRunGap                           NA\nReceiver                         NA\nReceiver_ID                      NA\nReception                      0.00\nReturnResult                     NA\nReturner                         NA\nBlockingPlayer                   NA\nTackler1                         NA\nTackler2                         NA\nFieldGoalResult                  NA\nFieldGoalDistance              0.14\nFumble                         0.00\nRecFumbTeam                      NA\nRecFumbPlayer                    NA\nSack                           0.00\nChallenge.Replay               0.00\nChalReplayResult                 NA\nAccepted.Penalty               0.00\nPenalizedTeam                    NA\nPenaltyType                      NA\nPenalizedPlayer                  NA\nPenalty.Yards                  0.01\nPosTeamScore                   0.02\nDefTeamScore                   0.02\nScoreDiff                      0.02\nAbsScoreDiff                   0.02\nHomeTeam                         NA\nAwayTeam                         NA\nTimeout_Indicator              0.00\nTimeout_Team                     NA\nposteam_timeouts_pre           0.00\nHomeTimeouts_Remaining_Pre     0.00\nAwayTimeouts_Remaining_Pre     0.00\nHomeTimeouts_Remaining_Post    0.00\nAwayTimeouts_Remaining_Post    0.00\nNo_Score_Prob                  0.00\nOpp_Field_Goal_Prob            0.00\nOpp_Safety_Prob                0.00\nOpp_Touchdown_Prob             0.00\nField_Goal_Prob                0.00\nSafety_Prob                    0.00\nTouchdown_Prob                 0.00\nExPoint_Prob                   0.00\nTwoPoint_Prob                  0.00\nExpPts                         0.00\nEPA                            0.00\nairEPA                         0.00\nyacEPA                         0.01\nHome_WP_pre                    0.00\nAway_WP_pre                    0.00\nHome_WP_post                   0.00\nAway_WP_post                   0.00\nWin_Prob                       0.00\nWPA                            0.00\nairWPA                         0.00\nyacWPA                         0.00\nSeason                         0.00\n\n#def2point is all NA in this version, but I am not interested in this variable anyway \nNFL_data &lt;- NFL_data %&gt;% select(-DefTwoPoint)\ncolSums(is.na(NFL_data))\n\n                       Date                      GameID \n                          0                           0 \n                      Drive                         qtr \n                          0                           0 \n                       down                        time \n                      34337                         127 \n                  TimeUnder                    TimeSecs \n                          0                         127 \n               PlayTimeDiff                 SideofField \n                        250                         297 \n                      yrdln                  yrdline100 \n                        472                         472 \n                    ydstogo                      ydsnet \n                          0                           0 \n                   GoalToGo                   FirstDown \n                        472                       16207 \n                    posteam               DefensiveTeam \n                      14018                       14018 \n                       desc               PlayAttempted \n                          0                           0 \n               Yards.Gained                          sp \n                          0                           0 \n                  Touchdown               ExPointResult \n                          0                      222221 \n               TwoPointConv                      Safety \n                     227461                           0 \n                 Onsidekick                  PuntResult \n                          0                      215512 \n                   PlayType                      Passer \n                          0                      132545 \n                  Passer_ID                 PassAttempt \n                          0                           0 \n                PassOutcome                  PassLength \n                     132517                      133087 \n                   AirYards             YardsAfterCatch \n                          0                           0 \n                      QBHit                PassLocation \n                          0                      133087 \n         InterceptionThrown                 Interceptor \n                          0                      225465 \n                     Rusher                   Rusher_ID \n                     161687                           0 \n                RushAttempt                 RunLocation \n                          0                      162276 \n                     RunGap                    Receiver \n                     180006                      136219 \n                Receiver_ID                   Reception \n                          0                           0 \n               ReturnResult                    Returner \n                     216233                      215139 \n             BlockingPlayer                    Tackler1 \n                     227856                       94492 \n                   Tackler2             FieldGoalResult \n                     201017                      222763 \n          FieldGoalDistance                      Fumble \n                     222832                           0 \n                RecFumbTeam               RecFumbPlayer \n                     225566                      225566 \n                       Sack            Challenge.Replay \n                          0                           0 \n           ChalReplayResult            Accepted.Penalty \n                     225855                           0 \n              PenalizedTeam                 PenaltyType \n                     210968                      218592 \n            PenalizedPlayer               Penalty.Yards \n                     211616                           0 \n               PosTeamScore                DefTeamScore \n                      15084                       15084 \n                  ScoreDiff                AbsScoreDiff \n                      14017                       15084 \n                   HomeTeam                    AwayTeam \n                          0                           0 \n          Timeout_Indicator                Timeout_Team \n                          0                           0 \n       posteam_timeouts_pre  HomeTimeouts_Remaining_Pre \n                          0                           0 \n AwayTimeouts_Remaining_Pre HomeTimeouts_Remaining_Post \n                          0                           0 \nAwayTimeouts_Remaining_Post               No_Score_Prob \n                          0                          99 \n        Opp_Field_Goal_Prob             Opp_Safety_Prob \n                         99                          99 \n         Opp_Touchdown_Prob             Field_Goal_Prob \n                         99                          99 \n                Safety_Prob              Touchdown_Prob \n                         99                          99 \n               ExPoint_Prob               TwoPoint_Prob \n                          0                           0 \n                     ExpPts                         EPA \n                         99                         198 \n                     airEPA                      yacEPA \n                     137833                      137894 \n                Home_WP_pre                 Away_WP_pre \n                      14015                       14015 \n               Home_WP_post                Away_WP_post \n                      14925                       14925 \n                   Win_Prob                         WPA \n                      14045                        3095 \n                     airWPA                      yacWPA \n                     137898                      138050 \n                     Season \n                          0 \n\nnames(NFL_data)\n\n  [1] \"Date\"                        \"GameID\"                     \n  [3] \"Drive\"                       \"qtr\"                        \n  [5] \"down\"                        \"time\"                       \n  [7] \"TimeUnder\"                   \"TimeSecs\"                   \n  [9] \"PlayTimeDiff\"                \"SideofField\"                \n [11] \"yrdln\"                       \"yrdline100\"                 \n [13] \"ydstogo\"                     \"ydsnet\"                     \n [15] \"GoalToGo\"                    \"FirstDown\"                  \n [17] \"posteam\"                     \"DefensiveTeam\"              \n [19] \"desc\"                        \"PlayAttempted\"              \n [21] \"Yards.Gained\"                \"sp\"                         \n [23] \"Touchdown\"                   \"ExPointResult\"              \n [25] \"TwoPointConv\"                \"Safety\"                     \n [27] \"Onsidekick\"                  \"PuntResult\"                 \n [29] \"PlayType\"                    \"Passer\"                     \n [31] \"Passer_ID\"                   \"PassAttempt\"                \n [33] \"PassOutcome\"                 \"PassLength\"                 \n [35] \"AirYards\"                    \"YardsAfterCatch\"            \n [37] \"QBHit\"                       \"PassLocation\"               \n [39] \"InterceptionThrown\"          \"Interceptor\"                \n [41] \"Rusher\"                      \"Rusher_ID\"                  \n [43] \"RushAttempt\"                 \"RunLocation\"                \n [45] \"RunGap\"                      \"Receiver\"                   \n [47] \"Receiver_ID\"                 \"Reception\"                  \n [49] \"ReturnResult\"                \"Returner\"                   \n [51] \"BlockingPlayer\"              \"Tackler1\"                   \n [53] \"Tackler2\"                    \"FieldGoalResult\"            \n [55] \"FieldGoalDistance\"           \"Fumble\"                     \n [57] \"RecFumbTeam\"                 \"RecFumbPlayer\"              \n [59] \"Sack\"                        \"Challenge.Replay\"           \n [61] \"ChalReplayResult\"            \"Accepted.Penalty\"           \n [63] \"PenalizedTeam\"               \"PenaltyType\"                \n [65] \"PenalizedPlayer\"             \"Penalty.Yards\"              \n [67] \"PosTeamScore\"                \"DefTeamScore\"               \n [69] \"ScoreDiff\"                   \"AbsScoreDiff\"               \n [71] \"HomeTeam\"                    \"AwayTeam\"                   \n [73] \"Timeout_Indicator\"           \"Timeout_Team\"               \n [75] \"posteam_timeouts_pre\"        \"HomeTimeouts_Remaining_Pre\" \n [77] \"AwayTimeouts_Remaining_Pre\"  \"HomeTimeouts_Remaining_Post\"\n [79] \"AwayTimeouts_Remaining_Post\" \"No_Score_Prob\"              \n [81] \"Opp_Field_Goal_Prob\"         \"Opp_Safety_Prob\"            \n [83] \"Opp_Touchdown_Prob\"          \"Field_Goal_Prob\"            \n [85] \"Safety_Prob\"                 \"Touchdown_Prob\"             \n [87] \"ExPoint_Prob\"                \"TwoPoint_Prob\"              \n [89] \"ExpPts\"                      \"EPA\"                        \n [91] \"airEPA\"                      \"yacEPA\"                     \n [93] \"Home_WP_pre\"                 \"Away_WP_pre\"                \n [95] \"Home_WP_post\"                \"Away_WP_post\"               \n [97] \"Win_Prob\"                    \"WPA\"                        \n [99] \"airWPA\"                      \"yacWPA\"                     \n[101] \"Season\"                     \n\n\n\n\nThere are a couple things off the top of my head I’d be interested in. One is the percent of 2 point conversions, because there are a lot of times I question the decision of these and also I know 2 point attempt rates have been increasing. Another is TJ Watt’s stats compared to other defensive players because I think he gets snubbed every year for DPOY.\nHere I am just listing out the variables that I think I will be most interested in so I can subset the data set down to it.\n\nsp = Binary indicatior for whether or not a score occured on the play\nyrdln = String indicating the current field position for a given play\ndesc = Detailed string description for the given play play_type = String indicating the type of play: pass (includes sacks), run (includes scrambles), punt, field_goal, kickoff, extra_point, qb_kneel, qb_spike, no_play (timeouts and penalties), and missing for rows indicating end of play.\nyards.gained = Numeric yards gained (or lost) for the given play.\nyrdline100 = Numeric distance in the number of yards from the opponent’s endzone for the posteam.\nhometeam = String abbreviation for the home team.\nawayteam = String abbreviation for the home team.\nposteam = String abbreviation for the team with possession.\nposteamscore = score of the team with possession\ndefteamscore = score of the team on defense\ndown = The down for the given play\nqtr = Quarter of the game (5 is overtime).\nydsnet = Numeric value for total yards gained on the given drive.\nPassLength = String indicator for pass length: short or deep.\ntwopointconv = String indicator for result of two point conversion attempt: success, failure, safety (touchback in defensive endzone is 1 point apparently), or return.\ntimeout_indicator = Binary indicator for whether or not a timeout was called.\ntimeout_team = team that called the timeout\nepa = Expected points added (EPA) by the posteam for the given play: I am not going to mess with the EPA variables at all because it isn’t clear how they were calculated. Same goes for wp (win probability) variables.\npassoutcome= outcome of pass\ninterceptionthrown = binary indicator for if the pass was intercepted\nfumble = binary indicator for if a fumble occured\nsack = Binary indicator for if the play ended in a sack.\ntouchdown = Binary indicator for if the play resulted in a TD.\nTackler1 = String name of one of the players with a tackle assist.\nTackler2 = String name of one of the players with a tackle assist.\n\nI don’t think there is really enough information to fairly judge TJ, but I still think he deserves DPOY.\nI am just going to focus on two-point conversion attempts and 4th and short (less than or equal to two yards) conversions for touchdowns.\n\n\n\nHere lets create some basic contingency tables for the 5 seasons we are interested in and accompaning plots.\n\n#Creating seperate tibbles for each year and removing probabilities variables because I am not interested in them \n\nyr2013&lt;- NFL_data %&gt;% filter(Season == 2013) %&gt;% select(-contains(\"WPA\"), -contains(\"WP\"), -contains(\"EPA\"), -contains(\"Prob\"))\n\nyr2014&lt;- NFL_data %&gt;% filter(Season == 2014) %&gt;% select(-contains(\"WPA\"), -contains(\"WP\"), -contains(\"EPA\"), -contains(\"Prob\"))\n\nyr2015&lt;- NFL_data %&gt;% filter(Season == 2015) %&gt;% select(-contains(\"WPA\"), -contains(\"WP\"), -contains(\"EPA\"), -contains(\"Prob\"))\n\nyr2016&lt;- NFL_data %&gt;% filter(Season == 2016) %&gt;% select(-contains(\"WPA\"), -contains(\"WP\"), -contains(\"EPA\"), -contains(\"Prob\"))\n\nyr2017&lt;- NFL_data %&gt;% filter(Season == 2017) %&gt;% select(-contains(\"WPA\"), -contains(\"WP\"), -contains(\"EPA\"), -contains(\"Prob\"))\n\n#Individual seasons contingency tables for two point conversions \ntwopt_2013 &lt;- table(yr2013$TwoPointConv)\ntwopt_2013\n\n\nFailure Success \n     38      33 \n\ntwopt_2014 &lt;- table(yr2014$TwoPointConv)\ntwopt_2014\n\n\nFailure Success \n     31      28 \n\ntwopt_2015 &lt;- table(yr2015$TwoPointConv)\ntwopt_2015\n\n\nFailure Success \n     46      43 \n\ntwopt_2016 &lt;- table(yr2016$TwoPointConv)\ntwopt_2016\n\n\nFailure Success \n     52      47 \n\ntwopt_2017 &lt;- table(yr2017$TwoPointConv)\ntwopt_2017\n\n\nFailure Success \n     44      33 \n\n#Multiyear contingency table (Can't just use table function because they dont have the same counts)\ntemp_2013 &lt;- c(Failure = 38, Success = 33)\ntemp_2014 &lt;- c(Failure = 31, Success = 28)\ntemp_2015 &lt;- c(Failure = 46, Success = 43)\ntemp_2016 &lt;- c(Failure = 52, Success = 47)\ntemp_2017 &lt;- c(Failure = 44, Success = 33)\n\n  # Combine data\nmultiyr_2ptdata &lt;- rbind(temp_2013, temp_2014, temp_2015, temp_2016, temp_2017)\n\n  # Assign row and column names for better interpretation\nrownames(multiyr_2ptdata) &lt;- c(\"2013\", \"2014\", \"2015\", \"2016\", \"2017\")\ncolnames(multiyr_2ptdata) &lt;- c(\"Failure\", \"Success\")\n\nmultiyr_2ptdata\n\n     Failure Success\n2013      38      33\n2014      31      28\n2015      46      43\n2016      52      47\n2017      44      33\n\n#barplot of data to view any trends\nmulti_2ptdata&lt;- as.data.frame(multiyr_2ptdata)\n  #Adding column for the year \nmulti_2ptdata$year &lt;- rownames(multiyr_2ptdata)\n  #reshaping for ggplot, i like this function from reshape2\n  multi_2pt_long&lt;- melt(multi_2ptdata, id.vars = \"year\")\n  #plotting\n  ggplot(multi_2pt_long, aes(x = year, y = value, fill = variable)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = \"Two-Point Conversion Successes and Failures by Year\",\n       x = \"Year\",\n       y = \"Count\") +\n  scale_fill_manual(values = c(\"Failure\" = \"red\", \"Success\" = \"green\")) +\n  theme_minimal()\n\n\n\n#Definitely seems to have a slightly positive trend in attempts! \n\n\n\n\n\n\n\nfourth_2013&lt;- yr2013 %&gt;% filter(down == 4, yrdline100 &lt;= 2)\nfourth_2014&lt;- yr2014 %&gt;% filter(down == 4, yrdline100 &lt;= 2)\nfourth_2015&lt;- yr2015 %&gt;% filter(down == 4, yrdline100 &lt;= 2)\nfourth_2016&lt;- yr2016 %&gt;% filter(down == 4, yrdline100 &lt;= 2)\nfourth_2017&lt;- yr2017 %&gt;% filter(down == 4, yrdline100 &lt;= 2)\n\ntable(fourth_2013$Touchdown)\n\n\n 0  1 \n67 23 \n\ntable(fourth_2014$Touchdown)\n\n\n 0  1 \n52 13 \n\ntable(fourth_2015$Touchdown)\n\n\n 0  1 \n48 16 \n\ntable(fourth_2016$Touchdown)\n\n\n 0  1 \n46 19 \n\ntable(fourth_2017$Touchdown)\n\n\n 0  1 \n47 16 \n\n#Multiyear contingency table (Can't just use table function because they dont have the same counts)\nfour_temp_2013 &lt;- c(Failure = 67, Success = 23)\nfour_temp_2014 &lt;- c(Failure = 52, Success = 13)\nfour_temp_2015 &lt;- c(Failure = 48, Success = 16)\nfour_temp_2016 &lt;- c(Failure = 46, Success = 19)\nfour_temp_2017 &lt;- c(Failure = 47, Success = 16)\n\n  # Combine data\nmultiyr_fourthdata &lt;- rbind(four_temp_2013, four_temp_2014, four_temp_2015, four_temp_2016, four_temp_2017)\n\n  # Assign row and column names for better interpretation\nrownames(multiyr_fourthdata) &lt;- c(\"2013\", \"2014\", \"2015\", \"2016\", \"2017\")\ncolnames(multiyr_fourthdata) &lt;- c(\"Failure\", \"Success\")\n\nmultiyr_fourthdata\n\n     Failure Success\n2013      67      23\n2014      52      13\n2015      48      16\n2016      46      19\n2017      47      16\n\n#barplot of data to view any trends\nmulti_fourthdata&lt;- as.data.frame(multiyr_fourthdata)\n  #Adding column for the year \nmulti_fourthdata$year &lt;- rownames(multiyr_fourthdata)\n  #reshaping for ggplot, i like this function from reshape2\n  multi_fourth_long&lt;- melt(multi_fourthdata, id.vars = \"year\")\n  #plotting\n  ggplot(multi_fourth_long, aes(x = year, y = value, fill = variable)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = \"Fourth and Short Conversion Successes and Failures by Year\",\n       x = \"Year\",\n       y = \"Count\") +\n  scale_fill_manual(values = c(\"Failure\" = \"red\", \"Success\" = \"green\")) +\n  theme_minimal()\n\n\n\n  #Hey, the amount of failures has decreased at least! Just kidding, this isn't a fair measure because it looks like overall attempts have decreased from 2013-2017. \n\n\n\n\n\nFirst we will view bar plots of the count data of success and failures, then look at conversion rates\n\n  #Filter the dataset for two-point conversion plays\ntwo_point_plays &lt;- NFL_data %&gt;%\n  filter(TwoPointConv %in% c(\"Success\", \"Failure\"))\n\n  #create a contingency table based on team, year, and two-point conversion success\ncontingency_2pt_by_team_year &lt;- table(two_point_plays$posteam, \n                                         two_point_plays$Season, \n                                         two_point_plays$TwoPointConv)\n\n  #View the contingency table\ncontingency_2pt_by_team_year\n\n, ,  = Failure\n\n     \n      2013 2014 2015 2016 2017\n  ARI    3    3    0    3    1\n  ATL    0    1    1    4    1\n  BAL    1    3    2    1    1\n  BUF    0    0    4    0    1\n  CAR    0    1    0    3    1\n  CHI    2    1    3    0    1\n  CIN    1    0    1    0    0\n  CLE    1    1    1    2    0\n  DAL    2    0    0    2    4\n  DEN    1    0    1    1    1\n  DET    3    2    3    1    3\n  GB     4    1    2    2    1\n  HOU    0    0    1    0    3\n  IND    2    3    1    1    1\n  JAC    1    2    4    0    0\n  JAX    0    0    0    0    2\n  KC     0    2    2    0    1\n  LA     0    0    0    1    0\n  LAC    0    0    0    0    1\n  MIA    1    1    1    1    1\n  MIN    1    1    0    2    0\n  NE     2    1    0    1    0\n  NO     1    1    2    3    0\n  NYG    0    0    0    0    4\n  NYJ    0    4    0    0    3\n  OAK    0    0    2    2    0\n  PHI    6    0    0    2    1\n  PIT    1    0    3    6    3\n  SD     0    0    1    1    0\n  SEA    1    1    3    1    3\n  SF     0    0    1    0    1\n  STL    1    0    1    0    0\n  TB     0    0    2    3    5\n  TEN    0    1    3    5    0\n  WAS    3    1    1    4    0\n\n, ,  = Success\n\n     \n      2013 2014 2015 2016 2017\n  ARI    1    2    0    1    1\n  ATL    1    1    1    2    0\n  BAL    3    1    1    3    0\n  BUF    2    2    2    4    0\n  CAR    0    1    0    3    0\n  CHI    5    5    2    0    1\n  CIN    0    1    1    0    0\n  CLE    1    0    2    2    1\n  DAL    1    0    1    0    1\n  DEN    0    2    0    0    2\n  DET    2    1    0    0    2\n  GB     0    1    4    2    1\n  HOU    1    0    2    0    2\n  IND    4    0    1    2    1\n  JAC    0    1    1    0    0\n  JAX    0    0    0    2    3\n  KC     0    0    1    1    0\n  LA     0    0    0    0    0\n  LAC    0    0    0    0    0\n  MIA    0    1    1    1    1\n  MIN    0    4    1    1    2\n  NE     2    0    0    1    2\n  NO     0    0    1    2    1\n  NYG    1    0    1    0    1\n  NYJ    0    0    0    1    1\n  OAK    0    0    1    5    2\n  PHI    3    0    0    4    3\n  PIT    1    4    8    3    2\n  SD     0    0    2    0    0\n  SEA    0    0    1    1    2\n  SF     0    0    1    2    0\n  STL    3    1    1    0    0\n  TB     0    0    1    4    1\n  TEN    0    0    3    0    0\n  WAS    2    0    2    0    0\n\ncontingency2pt_df &lt;- as.data.frame(contingency_2pt_by_team_year)\ncolnames(contingency2pt_df) &lt;- c(\"Team\", \"Year\", \"TwoPointConv\", \"Count\")\n\n#Plotting\ncombined2pt_data &lt;- contingency2pt_df %&gt;%\n  group_by(Team, TwoPointConv) %&gt;%\n  summarise(Count = sum(Count)) %&gt;%\n  ungroup()\n\n`summarise()` has grouped output by 'Team'. You can override using the\n`.groups` argument.\n\nggplot(combined2pt_data, aes(x = Team, y = Count, fill = factor(TwoPointConv))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = \"Two-Point Conversion Success by Team (2013-2017)\",\n       x = \"Team\",\n       y = \"Count of Two-Point Conversions\",\n       fill = \"Two-Point Conversion\") +\n  scale_fill_manual(values = c(\"Failure\" = \"red\", \"Success\" = \"green\"),\n                    labels = c(\"Failure\" = \"Failure\", \"Success\" = \"Success\")) +\n  theme_minimal() +\n  facet_wrap(~ TwoPointConv)  # To separate failures and successes in the plot\n\n\n\n#obviously this isn't the best graph because there are so many teams, but thinking ahead to the app, I am thinking people could filter the graph on their team(s) of choice.\n\n#filter on selected team \nselected_team = \"PIT\"\n  #filter the two-point conversion plays for the selected team\ntwo_point_plays_team &lt;- two_point_plays %&gt;%\n  filter(posteam == selected_team)\n  \ncontingency_2pt_by_year &lt;- table(two_point_plays_team$Season, \n                                     two_point_plays_team$TwoPointConv)\n\n  #Convert the contingency table to a data frame\nselected_team_2pt_df &lt;- as.data.frame(contingency_2pt_by_year)\ncolnames(selected_team_2pt_df) &lt;- c(\"Year\", \"TwoPointConv\", \"Count\")\n\n  #Plotting\nggplot(selected_team_2pt_df, aes(x = factor(Year), y = Count, fill = factor(TwoPointConv))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = paste(\"Two-Point Conversion Success for\", selected_team, \"(2013-2017)\"),\n       x = \"Year\",\n       y = \"Count of Two-Point Conversions\",\n       fill = \"Two-Point Conversion\") +\n  scale_fill_manual(values = c(\"Failure\" = \"red\", \"Success\" = \"green\"),\n                    labels = c(\"Failure\" = \"Failure\", \"Success\" = \"Success\")) +\n  theme_minimal()\n\n\n\n#Who would've thought, highest failure rate the year Matt Canada takes over\n\n# Function to calculate conversion rates for each team by year\ncalculate_twopt_conv &lt;- function(data, selected_teams) {\n  data %&gt;% \n  mutate(TwoPointConv = ifelse(TwoPointConv == \"Success\", 1, 0)) %&gt;% \n    filter(posteam %in% selected_teams & !is.na(TwoPointConv)) %&gt;% \n    group_by(Season,posteam) %&gt;% \n    summarise(TotalAttempts = n(),\n              Successful = sum(TwoPointConv, na.rm = TRUE),\n              ConversionRate = Successful/TotalAttempts,\n              Type = \"Two-Point Conversion\") %&gt;%\n    mutate(Team=posteam) %&gt;% select(-posteam)\n}\n\n#testing function \ncalculate_twopt_conv(NFL_data,selected_teams = c(\"PIT\",\"CLE\"))\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 10 × 6\n# Groups:   Season [5]\n   Season TotalAttempts Successful ConversionRate Type                 Team \n    &lt;dbl&gt;         &lt;int&gt;      &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;\n 1   2013             2          1          0.5   Two-Point Conversion CLE  \n 2   2013             2          1          0.5   Two-Point Conversion PIT  \n 3   2014             1          0          0     Two-Point Conversion CLE  \n 4   2014             4          4          1     Two-Point Conversion PIT  \n 5   2015             3          2          0.667 Two-Point Conversion CLE  \n 6   2015            11          8          0.727 Two-Point Conversion PIT  \n 7   2016             4          2          0.5   Two-Point Conversion CLE  \n 8   2016             9          3          0.333 Two-Point Conversion PIT  \n 9   2017             1          1          1     Two-Point Conversion CLE  \n10   2017             5          2          0.4   Two-Point Conversion PIT  \n\n\n\n\n\nFirst we will view bar plots of the count data of success and failures, then look at conversion rates\n\n# Filter the dataset for fourth down plays\nfourth_down_plays &lt;- NFL_data %&gt;%\n  filter(down == 4 & yrdline100 &lt;= 2) \n\n# Create a contingency table based on team, year, and touchdown success\ncontingency_4th_by_team_year &lt;- table(fourth_down_plays$posteam, \n                                         fourth_down_plays$Season, \n                                         fourth_down_plays$Touchdown)\n\n# View the contingency table\ncontingency_4th_by_team_year\n\n, ,  = 0\n\n     \n      2013 2014 2015 2016 2017\n  ARI    0    0    1    0    3\n  ATL    5    2    3    1    4\n  BAL    1    3    3    1    1\n  BUF    4    0    3    3    4\n  CAR    1    0    3    1    3\n  CHI    3    2    2    0    2\n  CIN    1    1    1    1    0\n  CLE    2    0    1    1    1\n  DAL    2    0    2    0    1\n  DEN    2    4    3    2    2\n  DET    2    2    1    0    3\n  GB     3    4    3    3    0\n  HOU    3    1    2    2    1\n  IND    0    2    0    2    1\n  JAC    1    0    3    0    0\n  JAX    0    0    0    0    1\n  KC     3    2    0    1    1\n  LA     0    0    0    2    1\n  LAC    0    0    0    0    2\n  MIA    2    3    3    0    0\n  MIN    0    1    1    2    2\n  NE     4    5    1    3    0\n  NO     4    3    1    3    2\n  NYG    1    3    2    1    2\n  NYJ    2    0    1    1    1\n  OAK    3    0    0    4    1\n  PHI    2    2    0    5    1\n  PIT    0    1    3    0    2\n  SD     3    1    0    1    0\n  SEA    3    4    0    1    1\n  SF     2    2    1    0    1\n  STL    2    1    1    0    0\n  TB     0    0    0    0    1\n  TEN    3    2    1    1    1\n  WAS    3    1    2    4    1\n\n, ,  = 1\n\n     \n      2013 2014 2015 2016 2017\n  ARI    1    0    0    0    0\n  ATL    0    2    0    1    0\n  BAL    1    0    1    1    0\n  BUF    1    0    1    1    1\n  CAR    3    0    0    1    0\n  CHI    1    0    0    1    0\n  CIN    3    1    1    1    1\n  CLE    2    0    0    0    0\n  DAL    0    2    0    0    0\n  DEN    2    0    1    0    0\n  DET    1    1    0    3    0\n  GB     0    1    0    0    0\n  HOU    0    1    0    1    0\n  IND    1    1    1    2    0\n  JAC    1    0    1    0    0\n  JAX    0    0    0    0    2\n  KC     0    0    1    0    0\n  LA     0    0    0    0    1\n  LAC    0    0    0    0    1\n  MIA    0    0    0    0    0\n  MIN    0    1    1    0    0\n  NE     0    0    1    1    1\n  NO     0    1    1    3    1\n  NYG    0    1    1    0    0\n  NYJ    1    0    0    0    1\n  OAK    1    1    0    1    0\n  PHI    1    0    1    1    1\n  PIT    1    0    0    0    1\n  SD     0    0    1    0    0\n  SEA    1    0    0    0    1\n  SF     0    0    0    1    3\n  STL    0    0    0    0    0\n  TB     0    0    0    0    1\n  TEN    1    0    2    0    0\n  WAS    0    0    1    0    0\n\ncontingency4th_df &lt;- as.data.frame(contingency_4th_by_team_year)\ncolnames(contingency4th_df) &lt;- c(\"Team\", \"Year\", \"Touchdown\", \"Count\")\n\n#Plotting\ncombined4th_data &lt;- contingency4th_df %&gt;%\n  group_by(Team, Touchdown) %&gt;%\n  summarise(Count = sum(Count)) %&gt;%\n  ungroup()\n\n`summarise()` has grouped output by 'Team'. You can override using the\n`.groups` argument.\n\nggplot(combined4th_data, aes(x = Team, y = Count, fill = factor(Touchdown))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = \"Fourth Down Touchdown Success by Team (2013-2017)\",\n       x = \"Team\",\n       y = \"Count of Touchdowns\",\n       fill = \"Touchdown\") +\n  scale_fill_manual(values = c(\"0\" = \"red\", \"1\" = \"green\"),\n                    labels = c(\"0\" = \"Failure\", \"1\" = \"Success\")) +\n  theme_minimal() +\n  facet_wrap(~ Touchdown)  # To separate failures and successes in the plot\n\n\n\n#Again, let's do this just with one team.. \n\n  #Filter the dataset for fourth down plays for the selected team\nfourth_down_plays_team &lt;- fourth_down_plays %&gt;%\n  filter(posteam == selected_team)\n\n  #Create a contingency table based on touchdown success for the team\ncontingency4th_table_by_team &lt;- table(fourth_down_plays_team$Season, fourth_down_plays_team$Touchdown)\n\ncontingency4th_table_by_team\n\n      \n       0 1\n  2013 0 1\n  2014 1 0\n  2015 3 0\n  2017 2 1\n\n  #Convert contingency table to a data frame for easier manipulation\nselected_team_4th_df &lt;- as.data.frame(contingency4th_table_by_team)\ncolnames(selected_team_4th_df) &lt;- c(\"Season\", \"Touchdown\", \"Count\")\n\n  #plotting\nggplot(selected_team_4th_df, aes(x = factor(Season), y = Count, fill = factor(Touchdown))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = paste(\"Fourth Down Touchdown Success for\", selected_team, \"(2013-2017)\"),\n       x = \"Season\",\n       y = \"Count of Fourth Down Attempts\",\n       fill = \"Touchdown Outcome\") +\n  scale_fill_manual(values = c(\"0\" = \"red\", \"1\" = \"green\"),\n                    labels = c(\"0\" = \"Failure\", \"1\" = \"Success\")) +\n  theme_minimal()\n\n\n\n##### Function for calculating 4th and short conversion rates for each team by year\ncalculate_4thdown_conv &lt;- function(data, selected_teams) {\n  data %&gt;%\n    filter(posteam %in% selected_teams & down == 4 & yrdline100 &lt;=2) %&gt;%\n    group_by(Season, posteam) %&gt;%\n    summarise(TotalAttempts = n(),\n              Successful = sum(Touchdown == 1, na.rm = TRUE),\n              ConversionRate = Successful / TotalAttempts,\n              Type = \"Fourth Down Conversion\") %&gt;% \n    mutate(Team = posteam) %&gt;% select(-posteam)\n}\n\n#testing function \ncalculate_4thdown_conv(NFL_data, c(\"PIT\",\"CLE\"))\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 8 × 6\n# Groups:   Season [5]\n  Season TotalAttempts Successful ConversionRate Type                   Team \n   &lt;dbl&gt;         &lt;int&gt;      &lt;int&gt;          &lt;dbl&gt; &lt;chr&gt;                  &lt;chr&gt;\n1   2013             4          2          0.5   Fourth Down Conversion CLE  \n2   2013             1          1          1     Fourth Down Conversion PIT  \n3   2014             1          0          0     Fourth Down Conversion PIT  \n4   2015             1          0          0     Fourth Down Conversion CLE  \n5   2015             3          0          0     Fourth Down Conversion PIT  \n6   2016             1          0          0     Fourth Down Conversion CLE  \n7   2017             1          0          0     Fourth Down Conversion CLE  \n8   2017             3          1          0.333 Fourth Down Conversion PIT  \n\n\n\n\n\nThese allow visual team comparisons of 2 point conversion rates and fourth and short conversion rates through the 2013-2017 seasons.\n\n#fourth down conversion rates needed for plot \ncalculate_4thdown_conv(NFL_data, c(\"PIT\",\"BAL\",\"CLE\",\"CIN\")) -&gt; AFCnorth\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\n #Create the line plot\nfourth_line_plot &lt;- ggplot(AFCnorth, aes(x = Season, y = ConversionRate, color = Team, group = Team)) +\n  geom_line(size = 1) +  # Line for each team\n  geom_point(size = 3) +  # Points at each season\n  labs(title = \"Fourth Down Conversion Rates by Team\",\n       x = \"Season\",\n       y = \"Conversion Rate\",\n       color = \"Team\") +\n  theme_minimal()\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n# Display the plot\nprint(fourth_line_plot)\n\n\n\n########## 2 point conversion rates \ncalculate_twopt_conv(NFL_data, c(\"KC\",\"JAX\")) -&gt;KCvJAX\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\n  #Create the line plot\nline_plot_2pt &lt;- ggplot(KCvJAX, aes(x = Season, y = ConversionRate, color = Team, group = Team)) +\n  geom_line(size = 1) +  # Line for each team\n  geom_point(size = 3) +  # Points at each season\n  labs(title = \"Two-Point Conversion Rates by Team\",\n       x = \"Season\",\n       y = \"Conversion Rate\",\n       color = \"Team\") +\n  theme_minimal()\n\n# Display the plot\nprint(line_plot_2pt)\n\n\n\n\n\n\n\n\n#Going to use the AFC North Teams again \n# Get conversion rates for two-point and fourth down for multiple teams\nAFCN_two_point_data &lt;- calculate_twopt_conv(NFL_data, c(\"PIT\",\"BAL\",\"CLE\",\"CIN\"))\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\nAFCN_fourth_down_data &lt;- calculate_4thdown_conv(NFL_data, c(\"PIT\",\"BAL\",\"CLE\",\"CIN\"))\n\n`summarise()` has grouped output by 'Season'. You can override using the\n`.groups` argument.\n\n#Combining datasets \nAFCN_all &lt;- bind_rows(AFCN_fourth_down_data,AFCN_two_point_data)\n\n#Plotting\nggplot(AFCN_all, aes(x=Season, y=ConversionRate, color= Team, linetype = Type, group = interaction(Team, Type))) +\n  geom_smooth(se=FALSE, size = 1.2) + #smoothed lines\n  geom_text(data = AFCN_all %&gt;% group_by(Team,Type) %&gt;% slice_max(Season),\n            aes(label=Team), hjust=1.2,size = 4) + #add team labels at the end of each line \n  labs(title= \"Two-point and Fourth Down Conversion Rates\",\n       x = \"Season\",\n       y = \"Conversion Rate\",\n       color = \"Team\",\n       linetype = \"Conversion Type\") + \n  scale_x_continuous(breaks = 2013:2017) + #setting axis for the 2013-2017 seasons \n  theme_minimal()\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 3.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 9.1204\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 1.01\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 1.0201\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: span too small.  fewer data values than degrees of freedom.\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: pseudoinverse used at 2013\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: neighborhood radius 2.02\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: reciprocal condition number 0\n\n\nWarning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,\n: There are other near singularities as well. 4.0804\n\n\n\n\n\n\n\n\n#Function to summarize numeric variables for specific team(s) \ncalculate_team_summary&lt;- function(data, selected_teams, quantitative_vars) {\n  data %&gt;% \n    filter(posteam %in% selected_teams) %&gt;% #filter for selected team(s)\n    group_by(posteam) %&gt;% #group by team\n    summarise(across(\n      all_of(quantitative_vars), #i am thinking in app i will give options for user\n      list(mean = ~mean(.x, na.rm = TRUE), sd = ~sd(.x, na.rm = TRUE), median = ~median(.x, na.rm= TRUE))\n    )) %&gt;% \n    ungroup()\n}\n\n#Example usage \ncalculate_team_summary(data = NFL_data, selected_teams = c(\"PIT\",\"CLE\"), quantitative_vars = c(\"yrdline100\", \"FieldGoalDistance\"))\n\n# A tibble: 2 × 7\n  posteam yrdline100_mean yrdline100_sd yrdline100_median FieldGoalDistance_mean\n  &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;                  &lt;dbl&gt;\n1 CLE                52.0          25.0                55                   37.3\n2 PIT                48.7          25.5                50                   36.6\n# ℹ 2 more variables: FieldGoalDistance_sd &lt;dbl&gt;,\n#   FieldGoalDistance_median &lt;dbl&gt;"
  }
]